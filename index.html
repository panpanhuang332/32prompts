<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ICS Lab Pro - V7.2 Triple Select</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>tailwind.config = { darkMode: 'media' }</script>
    <style>
        body { -webkit-tap-highlight-color: transparent; transition: background-color 0.4s ease; }
        .app-card { border-radius: 32px; transition: all 0.3s ease; }
        .gradient-header { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }
        @media (prefers-color-scheme: dark) { body { background-color: #0f172a; } }
        @keyframes dice-roll { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .rolling { animation: dice-roll 0.5s ease-in-out; }
        select { appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 1.2rem center; background-repeat: no-repeat; background-size: 1.2em; }
    </style>
</head>
<body class="p-4 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans pb-10 flex justify-center items-start">

    <div class="w-full max-w-md bg-white dark:bg-slate-800 app-card shadow-2xl overflow-hidden border border-gray-100 dark:border-slate-700">
        <div class="p-9 gradient-header text-white relative">
            <h1 class="text-3xl font-black italic flex items-center gap-3 relative z-10">
                <i class="fas fa-layer-group text-yellow-300"></i> ICS Lab Pro
            </h1>
            <p class="text-indigo-100 text-[10px] mt-2 font-bold tracking-[0.3em] opacity-90 uppercase relative z-10">V7.2 Triple-Tier Styles</p>
            <button onclick="randomStyleOnly()" class="absolute bottom-6 right-6 bg-white/20 hover:bg-white/30 backdrop-blur-md p-3 rounded-2xl border border-white/30 transition-all active:scale-90 group shadow-lg">
                <i id="diceIcon" class="fas fa-dice text-2xl text-white"></i>
            </button>
        </div>

        <div class="p-7 space-y-7">
            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-3 block tracking-[0.2em] uppercase">Step 01. åœ–ç‰‡é¡å‹</label>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="setType('general', this)" class="type-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-2.5 rounded-xl text-indigo-700 dark:text-indigo-300 text-[10px] font-bold transition-all">é€šç”¨åœ–åƒ</button>
                    <button onclick="setType('infographic', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">è³‡è¨Šåœ–è¡¨</button>
                    <button onclick="setType('diagram', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">åŠŸèƒ½åœ–è§£</button>
                    <button onclick="setType('flowchart', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">æµç¨‹åœ–</button>
                    <button onclick="setType('portrait', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">äººåƒæ”å½±</button>
                    <button onclick="setType('landscape', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">å£¯é—Šé¢¨æ™¯</button>
                </div>
            </section>

            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-3 block tracking-[0.2em] uppercase">Step 02. å…§å®¹ä¸»é¡Œ</label>
                <textarea id="content" rows="2" placeholder="ä½ æƒ³å‘ˆç¾ä»€éº¼ä¸»é¡Œå…§å®¹..." class="w-full p-4 bg-gray-50 dark:bg-slate-900/50 border border-gray-100 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-indigo-500 outline-none text-gray-700 dark:text-slate-200 transition-all text-sm"></textarea>
            </section>

            <section class="space-y-3">
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 block tracking-[0.2em] uppercase">Step 03. è¦–è¦ºé¢¨æ ¼ (ä¸‰å±¤çµ„åˆé¸å–®)</label>
                
                <select id="styleCategory" onchange="vibrate(); updateSpecificStyles()" class="w-full p-4 bg-indigo-50/50 dark:bg-slate-900 border border-indigo-100 rounded-2xl font-black text-indigo-600 text-sm">
                    <option value="" disabled selected>1. é¸æ“‡é¢¨æ ¼å¤§é¡åˆ¥...</option>
                    <option value="Photography">ğŸ“· æ”å½±èˆ‡ç…§ç‰‡é¢¨æ ¼</option>
                    <option value="Painting">ğŸ–Œï¸ ç¹ªç•«åª’æèˆ‡è³ªæ„Ÿ</option>
                    <option value="ArtMovements">ğŸ›ï¸ è—è¡“èˆ‡æ­·å²æµæ´¾</option>
                    <option value="FamousArtists">ğŸ¨ çŸ¥åè—è¡“å¤§å¸«</option>
                    <option value="AnimeComics">ğŸ¬ å‹•ç•«èˆ‡æ¼«ç•«é¢¨æ ¼</option>
                    <option value="DesignSpecial">âœ¨ ç‰¹æ®Šèˆ‡è¨­è¨ˆé¢¨æ ¼</option>
                    <option value="BusinessPro">ğŸ’¼ å°ˆæ¥­å•†å‹™æ‡‰ç”¨</option>
                </select>

                <select id="styleDetail" onchange="vibrate(); updatePreview()" class="w-full p-4 bg-gray-50 dark:bg-slate-900 border border-gray-100 rounded-2xl font-bold text-gray-700 text-sm" disabled>
                    <option value="">2. é¸æ“‡å…·é«”è¦–è¦ºé¢¨æ ¼...</option>
                </select>

                <select id="proPhotography" onchange="vibrate(); updatePreview()" class="w-full p-4 bg-gray-50 dark:bg-slate-900 border border-gray-100 rounded-2xl font-bold text-gray-700 text-sm">
                    <option value="" selected>3. å°ˆæ¥­æ”å½±/å…‰å½±åƒæ•¸ (å¯é¸)...</option>
                    <option value="macro lens">å¾®è·é¡é ­ Macro</option>
                    <option value="prime lens">å®šç„¦é¡é ­ Prime</option>
                    <option value="long focal length lens">æœ›é é¡é ­ Telephoto</option>
                    <option value="wide angle lens">å»£è§’é¡é ­ Wide Angle</option>
                    <option value="fish eye lens">é­šçœ¼é¡é ­ Fish-eye</option>
                    <option value="tilt shift lens">ç§»è»¸é¡é ­ Tilt-shift</option>
                    <option value="bokeh">æ•£æ™¯æ•ˆæœ Bokeh</option>
                    <option value="magic hour">é­”å¹»æ™‚åˆ» Magic Hour</option>
                    <option value="golden hour">é»ƒé‡‘æ™‚åˆ» Golden Hour</option>
                    <option value="blue hour">è—è‰²æ™‚åˆ» Blue Hour</option>
                    <option value="lens flare">é¡é ­çœ©å…‰ Lens Flare</option>
                    <option value="multiple exposure">é‡è¤‡æ›å…‰ Exposure</option>
                    <option value="panning">å¹³ç§»æ‹æ” Panning</option>
                    <option value="motion blur">å‹•æ…‹æ¨¡ç³Š Motion Blur</option>
                    <option value="vgnetting">æšˆå½±æš—è§’ Vignette</option>
                    <option value="ambient light">ç’°å¢ƒå…‰ç·š Ambient</option>
                    <option value="hard light">ç¡¬å…‰æ‰“æ³• Hard Light</option>
                    <option value="soft light">æŸ”å…‰æ‰“æ³• Soft Light</option>
                    <option value="back light">é€†å…‰èƒŒå…‰ Backlight</option>
                    <option value="rim light">è¼ªå»“å…‰ Rim Light</option>
                    <option value="HDR">é«˜å‹•æ…‹ç¯„åœ HDR</option>
                    <option value="4K HDR">æ¥µè‡´ HDR 4K</option>
                </select>

                <div id="previewCard" class="hidden p-4 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-indigo-100 animate-in fade-in shadow-inner">
                    <p id="previewText" class="text-xs text-indigo-600 dark:text-indigo-300 leading-relaxed font-bold"></p>
                </div>
            </section>

            <section class="space-y-3">
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 block tracking-[0.2em] uppercase">Step 04. é•·å¯¬æ¯”ä¾‹ (Aspect Ratio)</label>
                <select id="ratioSelect" onchange="vibrate(); handleRatioChange()" class="w-full p-4 bg-gray-50 dark:bg-slate-900 border border-gray-100 rounded-2xl font-bold text-gray-700 text-sm">
                    <option value="1:1">1:1 (æ­£æ–¹å½¢è²¼æ–‡)</option>
                    <option value="4:5">4:5 (IG å‚ç›´å„ªåŒ–)</option>
                    <option value="9:16" selected>9:16 (çŸ­å½±éŸ³/æ‰‹æ©Ÿå…¨è¢å¹•)</option>
                    <option value="16:9">16:9 (YouTube/é›»è…¦æ¡Œå¸ƒ)</option>
                    <option value="3:2">3:2 (å°ˆæ¥­ç›¸ç‰‡æ²–å°)</option>
                    <option value="21:9">21:9 (Notion/é›»å½±å¯¬å±)</option>
                    <option value="custom">âœï¸ è‡ªè¨‚é•·å¯¬ (Custom)</option>
                </select>
                <div id="customRatioBox" class="hidden">
                    <input type="text" id="customRatioInput" placeholder="è¼¸å…¥æ¯”ä¾‹ï¼Œä¾‹å¦‚ 2.35:1" class="w-full p-3 bg-indigo-50 dark:bg-slate-900 border border-indigo-200 rounded-xl text-xs font-mono outline-none text-indigo-600">
                </div>
            </section>

            <button onclick="vibrate(); generate()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-black py-4 rounded-2xl shadow-xl active:scale-[0.96] flex justify-center items-center gap-2 text-lg">
                ç”Ÿæˆæ‡¶äººæŒ‡ä»¤ <i class="fas fa-wand-magic-sparkles"></i>
            </button>

            <div id="resultBox" class="hidden animate-in zoom-in-95 duration-300 pb-4">
                <div class="bg-slate-900 rounded-[2rem] p-7 border border-slate-700 shadow-2xl relative">
                    <p id="finalPrompt" class="text-indigo-200 text-xs font-mono whitespace-pre-line leading-relaxed bg-slate-950 p-5 rounded-2xl border border-white/5 mb-6"></p>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="vibrate(); copyText()" class="bg-indigo-600 text-white p-4 rounded-xl text-xs font-black flex items-center justify-center"><i class="far fa-copy"></i></button>
                        <button onclick="vibrate(); shareLine()" class="bg-[#06C755] text-white p-4 rounded-xl text-xs font-black flex items-center justify-center"><i class="fab fa-line text-lg"></i></button>
                        <button onclick="vibrate(); shareFB()" class="bg-[#1877F2] text-white p-4 rounded-xl text-xs font-black flex items-center justify-center"><i class="fab fa-facebook text-lg"></i></button>
                    </div>
                </div>
            </div>

            <section id="historySection" class="pt-2 pb-6">
                <div class="flex items-center justify-between mb-4 px-1">
                    <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest">æ­·å²ç´€éŒ„</label>
                    <button onclick="vibrate(); clearHistory()" class="text-[10px] font-bold text-indigo-500">æ¸…é™¤</button>
                </div>
                <div id="historyList" class="space-y-3"></div>
            </section>
        </div>
    </div>

    <script>
        // --- é¡¯ç¤ºåç¨±å°ç…§è¡¨ (ä¾ç…§æ‚¨çš„è¦æ±‚å°‡æ”å½±åƒæ•¸èˆ‡ä¸€èˆ¬æ”å½±åˆ†é–‹) ---
        const styleDisplayNames = {
            "Photo": "æ¨™æº–ç…§ç‰‡ Photo", "life photo": "ç”Ÿæ´»ç…§ Life", "group photo": "åœ˜é«”ç…§ Group", "group selfie photo": "è‡ªæ‹åœ˜ç…§ Group Selfie", "selfie photo": "è‡ªæ‹ç…§ Selfie", "portrait photography": "äººåƒæ”å½± Portrait", "ports photography": "é‹å‹•æ”å½± Sports", "still life photo": "éœç‰©æ”å½± Still Life",
            "DSLR style": "æ•¸ä½å–®çœ¼ DSLR", "Polaroid style": "æ‹ç«‹å¾— Polaroid", "gopro style": "GoPro é¢¨æ ¼", "Fujifilm superia style": "å¯Œå£«åº•ç‰‡ Fujifilm", "LOMO style": "LOMO ç›¸æ©Ÿé¢¨æ ¼", "B/W style": "é»‘ç™½ç…§ç‰‡ B/W", "movie style": "é›»å½±é¢¨ movie", "cinematic photo style": "åŠ‡ç…§ cinematic", "Calotype print": "ç´™åŸºè² ç‰‡æ³• Calotype", "Holga photography": "Holga ç›¸æ©Ÿæ•ˆæœ", "vintage photo style": "å¾©å¤ç…§ç‰‡ vintage", "antique photo style": "ä»¿å¤ç…§ç‰‡ antique", "Albumen print": "è›‹ç™½æ˜ åƒ Albumen", "Anthotype print": "æ¤ç‰©æ„Ÿå…‰ç›¸ç´™",
            "Oil Painting": "å¤å…¸æ²¹ç•« Oil", "Watercolor": "é€æ˜æ°´å½© Watercolor", "Acrylic Painting": "å£“å…‹åŠ›ç•« Acrylic", "Sketch": "ç´ æè‰åœ– Sketch", "Charcoal Drawing": "ç‚­ç­†ç•« Charcoal", "Ink Drawing": "æ°´å¢¨ç•« Ink", "Ukiyo-e": "æ—¥æœ¬æµ®ä¸–ç¹ª Ukiyo-e", "Gongbi Painting": "ä¸­åœ‹å·¥ç­†ç•« Gongbi", "Printmaking": "ç‰ˆç•«é¢¨æ ¼ Printmaking", "Fresco": "æ¿•å£ç•« Fresco",
            "Renaissance": "æ–‡è—å¾©èˆˆ Renaissance", "Baroque": "å·´æ´›å…‹ Baroque", "Impressionism": "å°è±¡æ´¾ Impressionism", "Cubism": "ç«‹é«”æ´¾ Cubism", "Surrealism": "è¶…ç¾å¯¦ä¸»ç¾© Surrealism", "Pop Art": "æ™®æ™®è—è¡“ Pop Art", "Minimalism": "æ¥µç°¡ä¸»ç¾© Minimalism", "Cyberpunk": "è³½åšé¾å…‹ Cyberpunk", "Steampunk": "è’¸æ°£é¾å…‹ Steampunk",
            "Da Vinci": "é”æ–‡è¥¿ Da Vinci", "Van Gogh": "æ¢µè°· Van Gogh", "Picasso": "ç•¢å¡ç´¢ Picasso", "Dali": "é”åˆ© Dali", "Monet": "è«å…§ Monet", "Andy Warhol": "å®‰è¿ªæ²ƒè· Warhol", "Kusama Yayoi": "è‰é–“å½Œç”Ÿ Kusama",
            "Disney Animation": "è¿ªå£«å°¼é¢¨æ ¼ Disney", "Pixar Animation": "çš®å…‹æ–¯ 3D Pixar", "Studio Ghibli": "å‰åœåŠ›æ‰‹ç¹ª Ghibli", "Anime": "æ—¥æœ¬å‹•æ¼« Anime", "Manga": "æ—¥æœ¬æ¼«ç•« Manga", "American Comic": "ç¾å¼æ¼«ç•« Comic", "Claymation": "é»åœŸå®šæ ¼ Claymation",
            "Logo Design": "æ¨™èªŒè¨­è¨ˆ Logo", "Flat Design": "æ‰å¹³è¨­è¨ˆ Flat", "Infographic": "è³‡è¨Šåœ–è¡¨ Info", "Blueprint": "å·¥ç¨‹è—åœ– Blueprint", "Origami": "æ‘ºç´™è—è¡“ Origami", "Paper Cutout": "å‰ªç´™è—è¡“ Paper Cut", "Pixel Art": "åƒç´ è—è¡“ Pixel Art", "Isometric 3D": "ç­‰è·ç«‹é«” Isometric", "Low Poly": "ä½å¤šé‚Šå½¢ Low Poly", "3D Render": "3D æ¸²æŸ“ Render", "LEGO": "æ¨‚é«˜ç©æœ¨ LEGO",
            "McKinsey": "é¡§å•é¢¨ McKinsey", "Corporate": "ä¼æ¥­è³ªæ„Ÿ Corporate", "Professional": "å°ˆæ¥­ç°¡å ± Professional"
        };

        const proPhotographyNames = {
            "macro lens": "å¾®è·é¡é ­ Macro", "prime lens": "å®šç„¦é¡é ­ Prime", "long focal length lens": "æœ›é é¡é ­ Telephoto", "wide angle lens": "å»£è§’é¡é ­ Wide", "fish eye lens": "é­šçœ¼é¡é ­ Fish-eye", "tilt shift lens": "ç§»è»¸é¡é ­ Tilt-shift", "bokeh": "æ•£æ™¯æ•ˆæœ Bokeh", "magic hour": "é­”å¹»æ™‚åˆ» Magic Hour", "golden hour": "é»ƒé‡‘æ™‚åˆ» Golden Hour", "blue hour": "è—è‰²æ™‚åˆ» Blue Hour", "lens flare": "é¡é ­çœ©å…‰ Flare", "multiple exposure": "é‡è¤‡æ›å…‰ Exposure", "panning": "å¹³ç§»æ‹æ” Panning", "motion blur": "å‹•æ…‹æ¨¡ç³Š Motion Blur", "vgnetting": "æšˆå½±æš—è§’ Vignette", "ambient light": "ç’°å¢ƒå…‰ç·š Ambient", "hard light": "ç¡¬å…‰æ‰“æ³• Hard Light", "soft light": "æŸ”å…‰æ‰“æ³• Soft Light", "back light": "é€†å…‰èƒŒå…‰ Backlight", "rim light": "è¼ªå»“å…‰ Rim Light", "HDR": "é«˜å‹•æ…‹ç¯„åœ HDR", "4K HDR": "æ¥µè‡´ HDR 4K"
        };

        const categoryMap = {
            "Photography": ["Photo", "life photo", "group photo", "group selfie photo", "selfie photo", "portrait photography", "ports photography", "still life photo", "DSLR style", "Polaroid style", "gopro style", "Fujifilm superia style", "LOMO style", "B/W style", "movie style", "cinematic photo style", "Calotype print", "Holga photography", "vintage photo style", "antique photo style", "Albumen print", "Anthotype print"],
            "Painting": ["Oil Painting", "Watercolor", "Acrylic Painting", "Sketch", "Charcoal Drawing", "Ink Drawing", "Ukiyo-e", "Gongbi Painting", "Printmaking", "Fresco"],
            "ArtMovements": ["Renaissance", "Baroque", "Impressionism", "Cubism", "Surrealism", "Pop Art", "Minimalism", "Cyberpunk", "Steampunk"],
            "FamousArtists": ["Da Vinci", "Van Gogh", "Picasso", "Dali", "Monet", "Andy Warhol", "Kusama Yayoi"],
            "AnimeComics": ["Disney Animation", "Pixar Animation", "Studio Ghibli", "Anime", "Manga", "American Comic", "Claymation"],
            "DesignSpecial": ["Logo Design", "Flat Design", "Infographic", "Blueprint", "Origami", "Paper Cutout", "Pixel Art", "Isometric 3D", "Low Poly", "3D Render", "LEGO"],
            "BusinessPro": ["McKinsey", "Corporate", "Professional"]
        };

        // è©³ç´°è¦æ ¼èˆ‡è§£èªªåˆä½µ
        const styleSpecs = {
            "macro lens": { spec: "Macro lens, extreme close-up, microscopic details.", desc: "å¾®è·é¡é ­ï¼šæ‹æ”ååˆ†ç´°å¾®çš„ç‰©é«”ç¯€ã€‚" },
            "prime lens": { spec: "Prime lens photography, sharpest focus, fast aperture.", desc: "å®šç„¦é¡é ­ï¼šé€šå¸¸æ­é…ç„¦è·å’Œå…‰åœˆï¼Œç•«è³ªç´”æ·¨ã€‚" },
            "long focal length lens": { spec: "Telephoto lens > 50mm, compressed perspective.", desc: "æœ›é é¡é ­ï¼šç„¦è·å¤§æ–¼ 50mmï¼Œèƒ½æ‹‰è¿‘é æ–¹æ™¯ç‰©ã€‚" },
            "wide angle lens": { spec: "Wide angle lens < 35mm, expansive view.", desc: "å»£è§’é¡é ­ï¼šç„¦è·å°æ–¼ 35mmï¼Œè¦–é‡é¼é—Šã€‚" },
            "fish eye lens": { spec: "Fisheye lens < 16mm, extreme barrel distortion.", desc: "é­šçœ¼é¡é ­ï¼šç„¦è·å°æ–¼ 16mmï¼Œçƒç‹€æ‰­æ›²è¦–è§’ã€‚" },
            "tilt shift lens": { spec: "Tilt shift effect, miniature faking, selective focus.", desc: "ç§»è»¸é¡é ­ï¼šè®“å½±åƒä¸Šä¸‹æ¨¡ç³Šï¼Œä¸­é–“ä¸»è§’æ¸…æ¥šã€‚" },
            "bokeh": { spec: "Strong bokeh, soft out-of-focus background lights.", desc: "æ•£æ™¯ï¼šå¤±ç„¦å¾Œå‡ºç¾çš„ç¾éº—å…‰æšˆæ•ˆæœã€‚" },
            "magic hour": { spec: "Magic hour, twilight colors, beautiful sky glow.", desc: "é­”å¹»æ™‚åˆ»ï¼šå¤©ç©ºè‰²å½©æœ€ç¾çš„æ—¥å‡ºæˆ–æ—¥è½ç¬é–“ã€‚" },
            "golden hour": { spec: "Golden hour lighting, warm yellow sun, soft shadows.", desc: "é»ƒé‡‘æ™‚åˆ»ï¼šæ—¥è½å‰æº«æš–é£½æ»¿çš„é‡‘è‰²å…‰èŠ’ã€‚" },
            "blue hour": { spec: "Blue hour lighting, deep blue sky, urban twilight glow.", desc: "è—è‰²æ™‚åˆ»ï¼šæ—¥è½å¾Œå¤©ç©ºå‘ˆç¾æ·±é‚ƒè—è‰²çš„æ°›åœã€‚" },
            "lens flare": { spec: "Intentional lens flare, radiant light streaks.", desc: "é¡é ­çœ©å…‰ï¼šå‡ºç¾ä¸€äº›æ”¾å°„ç·šçš„çœ©å…‰æ„Ÿã€‚" },
            "multiple exposure": { spec: "Multiple exposure, layered multiple scenes, ghosting.", desc: "é‡è¤‡æ›å…‰ï¼šç•«é¢ä¸­å‡ºç¾å…©çµ„ä»¥ä¸Šä¸åŒçš„æ™¯ç‰©ã€‚" },
            "panning": { spec: "Panning technique, motion frozen subject, blurred lines.", desc: "å¹³ç§»æ‹æ”ï¼šé¡é ­è·Ÿéš¨ä¸»è§’ï¼Œå‘¨åœå‘ˆç¾æ°´å¹³æ¨¡ç³Šã€‚" },
            "motion blur": { spec: "Intentional motion blur, fluid movement trails.", desc: "å‹•æ…‹æ¨¡ç³Šï¼šå‘ˆç¾é‹å‹•ä¸­æ™¯ç‰©çš„æ¨¡ç³Šæµå‹•æ„Ÿã€‚" },
            "vgnetting": { spec: "Heavy vignetting, dark corners, center-focused.", desc: "æšˆå½±ï¼šç•«é¢å››å€‹è§’è½æœ‰ä¸åŒç¨‹åº¦çš„æš—å½±ã€‚" },
            "ambient light": { spec: "Natural ambient light, soft environmental glow.", desc: "ç’°å¢ƒå…‰ç·šï¼šä»¥ç¾å ´ç’°å¢ƒå…‰ç‚ºä¸»çš„æ‰“å…‰æ–¹å¼ã€‚" },
            "hard light": { spec: "Hard lighting, high contrast, sharp-edged shadows.", desc: "ç¡¬å…‰ï¼šå…‰ç·šé›†ä¸­ï¼Œé™°å½±é‚Šç·£éŠ³åˆ©æˆ²åŠ‡åŒ–ã€‚" },
            "soft light": { spec: "Soft lighting, diffused illumination, gentle rendering.", desc: "æŸ”å…‰ï¼šå…‰ç·šç™¼æ•£ï¼Œå‘ˆç¾æº«å’Œã€å‡å‹»çš„è³ªæ„Ÿã€‚" },
            "back light": { spec: "Backlighting, silhouette rim, glow from behind.", desc: "èƒŒå…‰ï¼šå…‰æºåœ¨ä¸»è§’å¾Œæ–¹ï¼Œå‘ˆç¾å‰ªå½±æˆ–èƒŒå…‰ç¾ã€‚" },
            "rim light": { spec: "Rim lighting, backlight glow, defined outlines.", desc: "è¼ªå»“å…‰ï¼šä¸»è§’å¾Œæ–¹æœ‰å…‰ï¼Œé‚Šç·£äº®èµ·å¢åŠ ç«‹é«”æ„Ÿã€‚" },
            "HDR": { spec: "High Dynamic Range, detailed shadows and highlights.", desc: "é«˜å‹•æ…‹ç¯„åœï¼šå¼·åŒ–æš—éƒ¨èˆ‡äº®éƒ¨çš„æ‰€æœ‰ç´°ç¯€ã€‚" },
            "4K HDR": { spec: "Ultra 4K HDR, extreme texture clarity, vivid tonal range.", desc: "4K é«˜å‹•æ…‹ç¯„åœï¼šæ¥µè‡´å¼·åŒ–ç´°ç¯€èˆ‡é€¼çœŸæ„Ÿã€‚" },
            "Photo": { spec: "Realistic photography, clear details.", desc: "æ¨™æº–å¯«å¯¦ç…§ç‰‡é¢¨æ ¼ã€‚" },
            "life photo": { spec: "Life photo, natural unposed candid scene.", desc: "ç”Ÿæ´»ç…§ï¼šè‡ªç„¶çš„ç”Ÿæ´»æ„Ÿç…§ç‰‡ã€‚" }
            // (å…¶é¤˜è¦æ ¼åœ¨ç”Ÿæˆé‚è¼¯ä¸­é€éé€šç”¨è¦å‰‡è™•ç†)
        };

        let selectedType = 'general';
        let history = JSON.parse(localStorage.getItem('prompt_history_v72') || '[]');

        function vibrate() { if (navigator.vibrate) navigator.vibrate(15); }

        function handleRatioChange() {
            const select = document.getElementById('ratioSelect');
            document.getElementById('customRatioBox').className = select.value === 'custom' ? 'block' : 'hidden';
        }

        function updateSpecificStyles(defaultStyle = "") {
            const category = document.getElementById('styleCategory').value;
            const styleDetail = document.getElementById('styleDetail');
            styleDetail.innerHTML = '<option value="">2. å†é¸æ“‡å…·é«”é¢¨æ ¼...</option>';
            styleDetail.disabled = !category;
            if (category && categoryMap[category]) {
                categoryMap[category].forEach(key => {
                    const opt = document.createElement('option');
                    opt.value = key; opt.textContent = styleDisplayNames[key] || key;
                    styleDetail.appendChild(opt);
                });
                if (defaultStyle) styleDetail.value = defaultStyle;
            }
            updatePreview();
        }

        function setType(type, btn) {
            selectedType = type;
            document.querySelectorAll('.type-btn').forEach(b => b.className = 'type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all');
            btn.className = 'type-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-2.5 rounded-xl text-indigo-700 dark:text-indigo-300 text-[10px] font-bold transition-all shadow-sm';
        }

        function randomStyleOnly() {
            vibrate();
            const icon = document.getElementById('diceIcon');
            icon.classList.add('rolling'); setTimeout(() => icon.classList.remove('rolling'), 500);
            const categories = Object.keys(categoryMap);
            const randomCat = categories[Math.floor(Math.random() * categories.length)];
            document.getElementById('styleCategory').value = randomCat;
            const randomStyle = categoryMap[randomCat][Math.floor(Math.random() * categoryMap[randomCat].length)];
            updateSpecificStyles(randomStyle);
        }

        function updatePreview() {
            const detail = document.getElementById('styleDetail').value;
            const pro = document.getElementById('proPhotography').value;
            const card = document.getElementById('previewCard');
            let hint = "";
            if (detail && styleSpecs[detail]) hint += "âœ¨ " + styleSpecs[detail].desc + " ";
            if (pro && styleSpecs[pro]) hint += "ğŸ“¸ " + styleSpecs[pro].desc;
            if (hint) { document.getElementById('previewText').innerText = hint; card.classList.remove('hidden'); }
            else { card.classList.add('hidden'); }
        }

        function generate() {
            const content = document.getElementById('content').value.trim() || "Amazing AI Art";
            const style = document.getElementById('styleDetail').value;
            const pro = document.getElementById('proPhotography').value;
            if(!style && !pro) return alert('è«‹è‡³å°‘é¸å–ä¸€å€‹è¦–è¦ºé¢¨æ ¼æˆ–å°ˆæ¥­æ”å½±è¦æ ¼ï¼');
            
            const ratioSelect = document.getElementById('ratioSelect').value;
            let arValue = ratioSelect === 'custom' ? (document.getElementById('customRatioInput').value || "1:1") : ratioSelect;
            
            let specsStr = (styleSpecs[style]?.spec || style) + (pro ? ", " + (styleSpecs[pro]?.spec || pro) : "");
            const prompt = `/imagine prompt: A combination of ${style || ""} ${pro || ""} style ${selectedType} about '${content}'. \n- ${specsStr} \n- Aspect ratio: ${arValue} --ar ${arValue} --v 6.1`;
            
            document.getElementById('finalPrompt').innerText = prompt;
            document.getElementById('resultBox').classList.remove('hidden');
            saveToHistory(style || pro, content, prompt);
        }

        function saveToHistory(s, c, p) {
            history.unshift({ style: s, content: c, prompt: p });
            if (history.length > 5) history.pop();
            localStorage.setItem('prompt_history_v72', JSON.stringify(history));
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = history.map((item, index) => `
                <div class="p-4 bg-gray-50 dark:bg-slate-900 rounded-2xl border flex justify-between items-center shadow-sm" onclick="loadFromHistory(${index})">
                    <div class="overflow-hidden">
                        <p class="text-[9px] font-black text-indigo-500 uppercase">${item.style}</p>
                        <p class="text-[12px] text-gray-700 dark:text-slate-300 font-bold truncate w-48">${item.content}</p>
                    </div><i class="fas fa-magic text-[10px] text-indigo-300"></i>
                </div>`).join('');
        }

        function loadFromHistory(i) {
            vibrate();
            document.getElementById('finalPrompt').innerText = history[i].prompt;
            document.getElementById('resultBox').classList.remove('hidden');
        }

        function clearHistory() { history = []; localStorage.removeItem('prompt_history_v72'); renderHistory(); }
        function copyText() { navigator.clipboard.writeText(document.getElementById('finalPrompt').innerText); alert('æŒ‡ä»¤å·²è¤‡è£½ï¼'); }
        function shareLine() { window.open(`https://line.me/R/msg/text/?${encodeURIComponent(document.getElementById('finalPrompt').innerText)}`); }
        function shareFB() { window.open(`https://www.facebook.com/sharer/sharer.php?u=${window.location.href}`); }
        renderHistory();
    </script>
</body>
</html>
