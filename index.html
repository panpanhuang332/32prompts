<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI ç”¢åœ–å¤§å¸« 9527</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // ã€ç¬¬ä¸€éƒ¨åˆ†ï¼šFirebase ç™»å…¥é…ç½®ã€‘(å¾æˆªåœ– 20251222_074845 å–å¾—)
        const firebaseConfig = {
            apiKey: "AIzaSyA7wvE5K5S6PyAlKOTM-PF7XNtikqEnCTQ",
            authDomain: "first-ai-50594.firebaseapp.com",
            projectId: "first-ai-50594",
            storageBucket: "first-ai-50594.firebasestorage.app",
            messagingSenderId: "125060763248",
            appId: "1:125060763248:web:68f308de378e0568052eb5"
        };

        // ã€ç¬¬äºŒéƒ¨åˆ†ï¼šGemini AI æ€è€ƒé‘°åŒ™ã€‘(ä½ å‰›å‰›æä¾›çš„é‚£ä¸€æŠŠ)
        const GEMINI_API_KEY = "AIzaSyABQ0n24ogxQqu75eio9fZJmE5qz3sk-HQ";

        // åˆå§‹åŒ– Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // ç™»å…¥åŠŸèƒ½é‚è¼¯
        window.login = async () => {
            try {
                await signInWithPopup(auth, provider);
            } catch (error) {
                console.error("ç™»å…¥è©³ç´°éŒ¯èª¤:", error);
                alert("ç™»å…¥å¤±æ•—ï¼è«‹å˜—è©¦ä½¿ç”¨ Chromeã€ç„¡ç—•æ¨¡å¼ã€é–‹å•Ÿç¶²é ã€‚");
            }
        };
        window.logout = () => signOut(auth);

        // ç›£è½ç™»å…¥ç‹€æ…‹åˆ‡æ› UI
        onAuthStateChanged(auth, (user) => {
            const loginBtn = document.getElementById('loginBtn');
            const userInfo = document.getElementById('userInfo');
            const userImg = document.getElementById('userImg');
            const generateBtn = document.getElementById('generateBtn');
            const loginRequiredMsg = document.getElementById('loginRequiredMsg');

            if (user) {
                loginBtn.classList.add('hidden');
                userInfo.classList.remove('hidden');
                userImg.src = user.photoURL;
                generateBtn.disabled = false;
                loginRequiredMsg.classList.add('hidden');
            } else {
                loginBtn.classList.remove('hidden');
                userInfo.classList.add('hidden');
                generateBtn.disabled = true;
                loginRequiredMsg.classList.remove('hidden');
            }
        });

        // --- AI æ€è€ƒèˆ‡è‡ªå‹•ç”¢åœ–æ ¸å¿ƒ ---
        window.generateImage = async () => {
            const content = document.getElementById('userInput').value.trim();
            if (!content) return alert("è«‹è¼¸å…¥æƒ³ç•«çš„ä¸»é¡Œ");
            
            const btn = document.getElementById('generateBtn');
            const loading = document.getElementById('loadingBox');
            const resultBox = document.getElementById('resultBox');
            const resultImg = document.getElementById('resultImg');
            const finalPrompt = document.getElementById('finalPrompt');

            btn.disabled = true;
            loading.classList.remove('hidden');
            resultBox.classList.add('hidden');

            try {
                // ä½¿ç”¨æ›´ç©©å®šçš„ 1.5-flash æ¨¡å‹é€²è¡Œæ¸¬è©¦ï¼Œé¿å… 404 éŒ¯èª¤
                const geminiUrl = `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;
                
                const response = await fetch(geminiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„ç¹ªåœ–æç¤ºè©å·¥ç¨‹å¸«ã€‚è«‹å°‡ä»¥ä¸‹ä¸­æ–‡ä¸»é¡Œæ“´å……æˆä¸€æ®µé«˜å“è³ªè‹±æ–‡ç¹ªåœ–æŒ‡ä»¤ï¼š${content}ã€‚åªéœ€è¦è¼¸å‡ºè‹±æ–‡æŒ‡ä»¤ï¼Œä¸è¦è§£é‡‹ã€‚` }] }]
                    })
                });

                const data = await response.json();
                
                // æª¢æŸ¥ Google æ˜¯å¦å›å‚³äº†å…·é«”çš„éŒ¯èª¤è¨Šæ¯
                if (data.error) {
                    throw new Error(`Google API å ±éŒ¯: ${data.error.message}`);
                }

                if (!data.candidates || !data.candidates[0]) {
                    throw new Error("AI æ²’æœ‰å›å‚³çµæœï¼Œè«‹ç¢ºèª API Key æ¬Šé™æˆ–æœå‹™æ˜¯å¦å·²å•Ÿç”¨ã€‚");
                }

                const optimizedPrompt = data.candidates[0].content.parts[0].text;
                finalPrompt.innerText = optimizedPrompt;

                // ç”¢åœ–éƒ¨åˆ†
                const imageUrl = `https://pollinations.ai/p/${encodeURIComponent(optimizedPrompt)}?width=1024&height=1024&seed=${Math.floor(Math.random()*99999)}&model=flux`;
                
                resultImg.src = imageUrl;
                resultImg.onload = () => {
                    loading.classList.add('hidden');
                    resultBox.classList.remove('hidden');
                    btn.disabled = false;
                };

            } catch (error) {
                console.error("AI è™•ç†è©³ç´°éŒ¯èª¤:", error);
                alert("ç”Ÿåœ–å¤±æ•—åŸå› ï¼š" + error.message);
                loading.classList.add('hidden');
                btn.disabled = false;
            }
        };
    </script>

    <style>
        body { background: #0f172a; font-family: 'PingFang TC', sans-serif; }
        .glass-card { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); border-radius: 2rem; }
        .gradient-btn { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }
        .loading-dot { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    </style>
</head>
<body class="p-4 flex justify-center items-start min-h-screen pt-10">

    <div class="w-full max-w-md space-y-6">
        <div class="flex justify-between items-center px-4">
            <div>
                <h1 class="text-white text-2xl font-black italic tracking-tighter">AI ç”¢åœ–å¤§å¸« <span class="text-indigo-400">9527</span></h1>
                <p class="text-slate-500 text-[10px] tracking-widest uppercase font-bold">Gemini 2.0 Inside</p>
            </div>
            <div id="authSection">
                <button id="loginBtn" onclick="login()" class="bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-xl text-xs font-bold transition-all border border-white/10">Google ç™»å…¥</button>
                <div id="userInfo" class="hidden flex items-center gap-2">
                    <img id="userImg" class="w-10 h-10 rounded-full border-2 border-indigo-500 shadow-lg">
                    <button onclick="logout()" class="text-[10px] text-slate-500 hover:text-white">ç™»å‡º</button>
                </div>
            </div>
        </div>

        <div class="glass-card p-8 shadow-2xl space-y-8">
            <div class="space-y-3">
                <label class="text-indigo-400 text-[10px] font-black tracking-widest uppercase">Step 01. ä½ çš„éˆæ„Ÿä¸»é¡Œ</label>
                <textarea id="userInput" rows="3" placeholder="ä¾‹å¦‚ï¼šç©¿è‘—å¤ªç©ºè£çš„å“ˆå£«å¥‡åœ¨ç«æ˜Ÿä¸Šè·³èˆ..." class="w-full bg-slate-900/50 border border-slate-700 text-white p-4 rounded-2xl outline-none focus:border-indigo-500 transition-all text-sm"></textarea>
            </div>

            <div class="space-y-4">
                <button id="generateBtn" disabled onclick="generateImage()" class="w-full gradient-btn text-white font-black py-5 rounded-2xl shadow-xl active:scale-95 transition-all disabled:opacity-30 disabled:grayscale">
                    AI æ€è€ƒä¸¦è‡ªå‹•ç”¢åœ– <i class="fas fa-sparkles ml-2"></i>
                </button>
                <p id="loginRequiredMsg" class="text-center text-xs text-rose-400 font-bold animate-pulse">ğŸ”’ è«‹å…ˆé»æ“Šå³ä¸Šè§’ç™»å…¥å¾Œæ‰å¯ç”Ÿåœ–</p>
            </div>

            <div id="loadingBox" class="hidden py-10 text-center space-y-4">
                <div class="inline-flex gap-2">
                    <div class="w-3 h-3 bg-indigo-500 rounded-full loading-dot"></div>
                    <div class="w-3 h-3 bg-purple-500 rounded-full loading-dot" style="animation-delay: 0.2s"></div>
                    <div class="w-3 h-3 bg-fuchsia-500 rounded-full loading-dot" style="animation-delay: 0.4s"></div>
                </div>
                <p class="text-indigo-300 text-xs font-bold">Gemini æ­£åœ¨æ€è€ƒæ“´å……ç´°ç¯€...</p>
            </div>

            <div id="resultBox" class="hidden space-y-6">
                <div class="rounded-2xl overflow-hidden border-2 border-indigo-500/30 shadow-2xl shadow-indigo-500/10">
                    <img id="resultImg" src="" class="w-full h-auto">
                </div>
                <div class="bg-black/40 p-5 rounded-2xl border border-white/5">
                    <label class="text-[10px] text-indigo-400 font-black block mb-2 uppercase tracking-tighter">AI å„ªåŒ–å¾Œçš„å°ˆæ¥­æŒ‡ä»¤ (Prompt)</label>
                    <p id="finalPrompt" class="text-xs text-slate-400 font-mono italic leading-relaxed"></p>
                </div>
            </div>
        </div>
    </div>

</body>
</html>




