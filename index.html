<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¸€æŒ‡æç¤º (AI å­¸ç¿’ç‰ˆ)</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#050505">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <style>
        :root {
            --bg-deep: #050505;
            --glass-border: rgba(255, 255, 255, 0.12);
            --text-main: #E0E0E0;
            --accent-glow: #3b82f6;
            --study-purple: #9c27b0;
        }
        body {
            background-color: var(--bg-deep); 
            color: var(--text-main); 
            font-family: 'Noto Sans TC', sans-serif;
            height: 100vh; height: 100dvh;
            display: flex; flex-direction: column;
            overflow: hidden;
            background-image: radial-gradient(circle at 50% 0%, #1a1a1a 0%, #050505 60%);
        }

        .app-header {
            background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(12px);
            padding: 15px 15px 5px 15px; border-bottom: 1px solid rgba(255,255,255,0.08); 
            flex-shrink: 0; z-index: 100;
        }
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .app-title { 
            margin: 0; font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 1.1rem; letter-spacing: 1px;
            background: linear-gradient(90deg, #fff, #999); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .mode-switch-container { display: flex; gap: 8px; margin-bottom: 15px; background: rgba(255,255,255,0.03); padding: 4px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); }
        .mode-btn { flex: 1; border: none; background: transparent; padding: 8px; font-size: 0.85rem; border-radius: 8px; color: #666; font-weight: 500; transition: all 0.3s; }
        .mode-btn.active { background: linear-gradient(145deg, #222, #111); color: #fff; border: 1px solid rgba(255,255,255,0.1); }
        .mode-btn.mode-study.active { border-color: var(--study-purple); color: #e1bee7; }

        .app-content { flex-grow: 1; overflow-y: auto; padding: 15px; }
        .category-card { background: linear-gradient(145deg, #111, #080808); border-radius: 16px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.05); border-top: 1px solid rgba(255,255,255,0.15); }
        
        .tab-content-area { display: none; }
        .tab-content-area.active { display: block; }

        .app-footer { background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(15px); padding: 15px 20px 25px 20px; border-top: 1px solid rgba(255,255,255,0.1); flex-shrink: 0; }
        
        /* è¼¸å‡ºæ¡†æ¨£å¼ */
        .output-box { background-color: #000; border: 1px solid #333; border-radius: 10px; padding: 10px; margin-bottom: 10px; }
        .prompt-label { font-size: 0.7rem; color: #888; margin-bottom: 5px; display: block; }
        #outputPrompt { color: #00ff9d; font-family: monospace; font-size: 0.9rem; width: 100%; background: transparent; border: none; outline: none; resize: none; }
        #translationPrompt { color: #3b82f6; font-size: 0.85rem; width: 100%; background: transparent; border: none; outline: none; resize: none; }
        
        .btn-speak { background: #222; color: #fff; border: 1px solid #444; border-radius: 50px; padding: 4px 12px; font-size: 0.75rem; margin-top: 5px; }

        /* ç›¸æ©Ÿé è¦½ */
        .camera-preview-box { width: 60px; height: 60px; border-radius: 10px; border: 1px solid #555; overflow: hidden; display: none; margin-right: 10px; position: relative; }
        .nav-tabs { border: none; gap: 8px; padding-bottom: 10px; flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        .nav-link { border: 1px solid transparent; border-radius: 20px; background: rgba(255,255,255,0.05); color: #888; font-size: 0.85rem; padding: 6px 14px; white-space: nowrap; }
        .nav-link.active { background: #fff; color: #000; font-weight: 700; }
        .disabled-tab { opacity: 0.3; }
    </style>
</head>
<body>

    <div class="app-header">
        <div class="top-bar">
            <h6 class="app-title">âœ¨ Prompts Language <span style="font-size:0.7em; opacity:0.7;">EDU</span></h6>
            <div id="userInfo" class="user-info"></div>
        </div>
        
        <div class="mode-switch-container">
            <button class="mode-btn active" onclick="setMode('create')" id="mode-create">ğŸ¨ ç¹ªåœ–æŒ‡ä»¤</button>
            <button class="mode-btn mode-study" onclick="setMode('study')" id="mode-study">ğŸ”® å­¸ç¿’æ¨¡å¼ (Coming Soon)</button>
        </div>

        <div class="d-flex align-items-center mb-2">
            <input type="file" id="cameraInput" accept="image/*" capture="environment" style="display: none;" onchange="handleImageSelect(this)">
            <div id="previewBox" class="camera-preview-box">
                <img id="finalImage" style="width:100%;height:100%;object-fit:cover;">
                <button onclick="clearPhoto()" style="position:absolute; top:0; right:0; background:rgba(0,0,0,0.5); color:white; border:none; font-size:10px;">âœ•</button>
            </div>
            <div class="input-group" id="mainInputGroup">
                <input type="text" class="form-control" id="mainSubject" placeholder="è¼¸å…¥å…§å®¹ (å¦‚: è²“)...">
                <button class="btn btn-dark" type="button" onclick="translateInput()">ä¸­è½‰è‹±</button>
            </div>
            <button class="btn btn-danger ms-2" id="cameraBtn" style="display:none; border-radius:12px; white-space:nowrap;" onclick="triggerCamera()">ğŸ“¸ æ‹ç…§å­¸ç¿’</button>
        </div>

        <div class="nav nav-tabs" id="myTab">
            <button class="nav-link active" onclick="switchTab(this, 'page-settings')">âš™ï¸ è¨­å®š</button>
            <button class="nav-link" onclick="switchTab(this, 'page-char')">ğŸ‘¤ äººç‰©</button>
            <button class="nav-link" onclick="switchTab(this, 'page-scene')">ğŸï¸ å ´æ™¯</button>
            <button class="nav-link disabled-tab" id="btn-photo" onclick="switchTab(this, 'page-photo')">ğŸ“¸ æ”å½±</button>
        </div>
    </div>

    <div class="app-content">
        <div id="study-hint" style="display:none;">
            <div class="category-card" style="border: 1px dashed #9c27b0;">
                <h5 style="color:#ce93d8;">ğŸ”® è‹±èªå­¸ç¿’å°ˆæ¡ˆ (é–‹ç™¼ä¸­)</h5>
                <p class="small text-secondary">æœ¬åŠŸèƒ½æœªä¾†å°‡é€£çµ AI åˆ†äº«åœ–ç‰‡ä¸­çš„è¦–è¦ºèªè¨€ã€‚æ‹ä¸‹ç…§ç‰‡å¾Œï¼Œç³»çµ±å°‡è‡ªå‹•ç”Ÿæˆåœ°é“çš„ Prompts æè¿°ï¼Œè®“æ‚¨å­¸ç¿’å¦‚ä½•ç²¾ç¢ºæè¿°å ´æ™¯ã€‚</p>
                <ul class="small text-info">
                    <li>âœ“ è¦–è¦ºå–®å­—å­¸ç¿’</li>
                    <li>âœ“ æè¿°å¥å‹åˆ†æ</li>
                    <li>âœ“ AI èªéŸ³æœ—è®€</li>
                </ul>
            </div>
        </div>

        <div id="page-settings" class="tab-content-area active">
             <div class="category-card">
                <label class="category-title">ğŸ“ åœ–ç‰‡æ¯”ä¾‹</label>
                <select class="form-select" id="aspectRatio"><option value="">1:1</option><option value="--ar 16:9">16:9</option></select>
             </div>
        </div>
        <div id="page-char" class="tab-content-area"><div id="container-char"></div></div>
        <div id="page-scene" class="tab-content-area"><div id="container-scene"></div></div>
        <div id="page-photo" class="tab-content-area"><div id="container-photo"></div></div>
    </div>

    <div class="app-footer">
        <div class="output-box">
            <span class="prompt-label">ENGLISH PROMPTS (èªè¨€å­¸ç¿’)</span>
            <textarea id="outputPrompt" rows="2" readonly placeholder="æ‹ä¸‹ç…§ç‰‡æˆ–çµ„åˆé¸å–®..."></textarea>
            <button class="btn-speak" id="speakBtn" onclick="speakText()">ğŸ”Š èªéŸ³æœ—è®€</button>
        </div>
        
        <div class="output-box" id="translationBox" style="display:none; border-color: #1e3a8a;">
            <span class="prompt-label">ä¸­æ–‡æ„æ€å°ç…§</span>
            <textarea id="translationPrompt" rows="2" readonly placeholder="ç¿»è­¯å°‡é¡¯ç¤ºæ–¼æ­¤..."></textarea>
        </div>

        <button class="btn btn-primary w-100 fw-bold py-3" style="border-radius:15px;" id="actionBtn" onclick="processAction()">âœ¨ ç”¢å‡ºæŒ‡ä»¤</button>
    </div>

<script>
    let currentMode = 'create';

    function setMode(mode) {
        currentMode = mode;
        const isStudy = mode === 'study';
        
        // åˆ‡æ›æŒ‰éˆ•ç‹€æ…‹
        document.getElementById('mode-create').classList.toggle('active', !isStudy);
        document.getElementById('mode-study').classList.toggle('active', isStudy);
        
        // åˆ‡æ›ä»‹é¢å…ƒç´ 
        document.getElementById('mainInputGroup').style.display = isStudy ? 'none' : 'flex';
        document.getElementById('cameraBtn').style.display = isStudy ? 'block' : 'none';
        document.getElementById('myTab').style.display = isStudy ? 'none' : 'flex';
        document.getElementById('study-hint').style.display = isStudy ? 'block' : 'none';
        document.getElementById('translationBox').style.display = isStudy ? 'block' : 'none';
        document.querySelectorAll('.tab-content-area').forEach(el => el.style.display = isStudy ? 'none' : '');
        if(!isStudy) document.getElementById('page-settings').classList.add('active');

        // ä¿®æ”¹åº•éƒ¨æŒ‰éˆ•æ–‡å­—
        const actionBtn = document.getElementById('actionBtn');
        actionBtn.textContent = isStudy ? "ğŸ” å•Ÿå‹• AI å­¸ç¿’åˆ†æ" : "âœ¨ ç”¢å‡ºç¹ªåœ–æŒ‡ä»¤";
        actionBtn.style.background = isStudy ? "linear-gradient(135deg, #6a1b9a, #4a148c)" : "";
    }

    function triggerCamera() { document.getElementById('cameraInput').click(); }

    function handleImageSelect(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('finalImage').src = e.target.result;
                document.getElementById('previewBox').style.display = 'block';
                
                if (currentMode === 'study') {
                    // æ¨¡æ“¬æœªä¾†çš„ AI è§£ææµç¨‹
                    document.getElementById('outputPrompt').value = "A high-tech digital camera capturing a moment, cinematic lighting, sharp focus on lens.";
                    document.getElementById('translationPrompt').value = "ä¸€å°æ•æ‰ç¬é–“çš„é«˜ç§‘æŠ€æ•¸ä½ç›¸æ©Ÿï¼Œé›»å½±æ„Ÿå…‰å½±ï¼Œç„¦è·ç²¾æº–å°ç„¦æ–¼é¡é ­ã€‚";
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function processAction() {
        if (currentMode === 'study') {
            if (!document.getElementById('finalImage').src.includes('data:image')) {
                alert("è«‹å…ˆæ‹æ”æˆ–ä¸Šå‚³ç…§ç‰‡ä»¥é€²è¡Œå­¸ç¿’åˆ†æï¼");
                return;
            }
            alert("AI åˆ†æé€£æ¥ä¸­...\nç›®å‰ç‚ºå±•ç¤ºæ¨¡å¼ï¼Œæœªä¾†å°‡ä¸²æ¥ Vision AI é€²è¡Œå³æ™‚è§£æã€‚");
        } else {
            // åŸæœ¬çš„ç”ŸæˆæŒ‡ä»¤é‚è¼¯...
            document.getElementById('outputPrompt').value = "Generated drawing prompt...";
        }
    }

    // Web Speech API: èªéŸ³æœ—è®€åŠŸèƒ½
    function speakText() {
        const text = document.getElementById('outputPrompt').value;
        if (!text) return alert("æ²’æœ‰å¯è®€å–çš„è‹±æ–‡å…§å®¹ï¼");
        
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = 0.9; // ç¨å¾®æ”¾æ…¢ä¸€é»é»ï¼Œæ–¹ä¾¿å­¸ç¿’
        window.speechSynthesis.speak(utterance);
    }

    function clearPhoto() {
        document.getElementById('finalImage').src = "";
        document.getElementById('previewBox').style.display = 'none';
        document.getElementById('outputPrompt').value = "";
        document.getElementById('translationPrompt').value = "";
    }

    // å…¶é¤˜åŸæœ¬çš„åˆ‡æ›é‚è¼¯ä¿æŒä¸è®Š...
    function switchTab(btn, id) {
        if(btn.classList.contains('disabled-tab')) return;
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.tab-content-area').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }
</script>
</body>
</html>
