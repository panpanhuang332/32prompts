<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI ç¹ªåœ–æç¤ºè©å·¥å…· (æ•™è‚²ç‰ˆ)</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffffff">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* --- æ ¸å¿ƒä½ˆå±€ --- */
        body { background-color: #f0f2f5; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        .app-header { background: white; padding: 15px 15px 0 15px; box-shadow: 0 1px 5px rgba(0,0,0,0.05); z-index: 10; flex-shrink: 0; }
        .nav-tabs { border-bottom: none; flex-wrap: nowrap; overflow-x: auto; white-space: nowrap; gap: 5px; padding-bottom: 5px; }
        .nav-tabs .nav-link { border: none; color: #6c757d; font-size: 0.95rem; padding: 8px 12px; border-radius: 20px; background-color: #f8f9fa; transition: all 0.2s; }
        .nav-tabs .nav-link.active { color: white; background-color: #4285f4; font-weight: bold; } /* Google Blue */
        .nav-tabs .nav-link.disabled-tab { opacity: 0.5; pointer-events: none; background-color: #e9ecef; }
        
        .app-content { flex-grow: 1; overflow-y: auto; padding: 15px; background-color: #f0f2f5; scroll-behavior: smooth; }
        .tab-content-area { display: none; animation: fadeIn 0.3s; }
        .tab-content-area.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .category-card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); transition: opacity 0.3s; }
        .category-card.disabled-card { opacity: 0.5; pointer-events: none; filter: grayscale(100%); }

        .category-title { font-size: 0.9rem; font-weight: bold; color: #343a40; margin-bottom: 8px; display: block; border-left: 4px solid #4285f4; padding-left: 8px; }
        .app-footer { background: white; padding: 10px 15px; border-top: 1px solid #dee2e6; flex-shrink: 0; z-index: 20; padding-bottom: max(10px, env(safe-area-inset-bottom)); }
        
        .loading-text { font-size: 0.8em; color: #4285f4; margin-top: 5px; display: none; }
        .form-select { background-color: #f8f9fa; border: 1px solid #e9ecef; }
        .form-select:disabled { background-color: #e9ecef; color: #adb5bd; cursor: not-allowed; }
        .nav-tabs::-webkit-scrollbar { display: none; }
        .locked-badge { display: none; font-size: 0.7rem; background: #dc3545; color: white; padding: 2px 6px; border-radius: 4px; margin-left: 5px; }

        .img-preview-container { position: relative; width: 60px; height: 60px; margin-right: 10px; display: none; }
        .img-preview { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; border: 2px solid #4285f4; }
        .btn-remove-img { position: absolute; top: -5px; right: -5px; background: red; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 10px; line-height: 18px; text-align: center; cursor: pointer; border: none; }
        
        /* æ¨¡å‹åˆ‡æ›æŒ‰éˆ•æ¨£å¼ */
        .model-switch { display: flex; gap: 5px; margin-bottom: 10px; background: #f0f2f5; padding: 4px; border-radius: 8px; }
        .model-btn { flex: 1; border: none; background: transparent; padding: 8px; font-size: 0.9rem; border-radius: 6px; color: #666; font-weight: bold; transition: all 0.2s; }
        .model-btn.active { background: white; color: #4285f4; box-shadow: 0 2px 4px rgba(0,0,0,0.1); } /* Google Blue */
        
        /* Gemini æ¨¡å¼ä¸‹éš±è—ä¸Šå‚³ç‹€æ…‹ï¼Œå› ç‚ºä¸éœ€è¦åœ–åºŠ */
        .gemini-mode .upload-related { display: none !important; } 
    </style>
</head>
<body>

    <div class="app-header">
        <h6 class="mb-2 fw-bold text-dark">ğŸ¨ AI ç¹ªåœ–æç¤ºè©å·¥å…· (EDU)</h6>
        
        <div class="model-switch">
            <button class="model-btn active" onclick="setModel('gemini')" id="btn-gemini">âœ¨ Gemini æ¨¡å¼</button>
            <button class="model-btn" onclick="setModel('mj')" id="btn-mj">Midjourney æ¨¡å¼</button>
        </div>

        <div class="mb-2">
            <div class="input-group mb-2">
                <input type="file" id="cameraInput" accept="image/*" capture="user" style="display: none;" onchange="handleImageSelect(this)">
                
                <div id="previewContainer" class="img-preview-container">
                    <img id="imgPreview" class="img-preview" src="">
                    <button class="btn-remove-img" onclick="removeImage()">Ã—</button>
                </div>

                <input type="text" class="form-control" id="mainSubject" placeholder="æè¿°ç•«é¢ä¸»é«” (æ”¯æ´ä¸­æ–‡)...">
                
                <button class="btn btn-outline-secondary" type="button" onclick="document.getElementById('cameraInput').click()">
                    ğŸ“¸
                </button>
                
                <button class="btn btn-outline-primary" type="button" id="translateBtn" onclick="translateInput()">
                    ä¸­ç¿»è‹±
                </button>
            </div>
            
            <div class="d-flex justify-content-between align-items-center">
                <div id="translationStatus" class="loading-text">æ­£åœ¨ç¿»è­¯ä¸­...</div>
                <div id="uploadStatus" class="upload-status text-end small text-muted upload-related" style="display:none;"></div>
            </div>
            <input type="hidden" id="uploadedImageUrl" value="">
        </div>

        <div class="nav nav-tabs" id="myTab" role="tablist">
            <button class="nav-link active" id="btn-settings" onclick="switchTab(this, 'page-settings')">âš™ï¸ è¨­å®š</button>
            <button class="nav-link" id="btn-photo" onclick="switchTab(this, 'page-photo')">ğŸ“¸ æ”å½±</button>
            <button class="nav-link" id="btn-art" onclick="switchTab(this, 'page-art')">ğŸ–Œï¸ è—è¡“ <span class="locked-badge">é–å®š</span></button>
            <button class="nav-link" id="btn-anime" onclick="switchTab(this, 'page-anime')">ğŸ§¸ å‹•æ¼« <span class="locked-badge">é–å®š</span></button>
        </div>
    </div>

    <div class="app-content">
        <div id="page-settings" class="tab-content-area active">
            <div class="category-card">
                <label class="category-title">ğŸ“ åœ–ç‰‡æ¯”ä¾‹ (Aspect Ratio)</label>
                <select class="form-select" id="aspectRatio">
                    <option value="" selected>1:1 (é è¨­æ­£æ–¹å½¢)</option>
                    <optgroup label="æ©«å‘">
                        <option value="16:9">16:9 (å¯¬è¢å¹•/YT)</option>
                        <option value="21:9">21:9 (Notionå°é¢)</option>
                        <option value="4:3">4:3 (æ¨™æº–ç…§ç‰‡)</option>
                    </optgroup>
                    <optgroup label="ç›´å‘">
                        <option value="4:5">4:5 (IG è²¼æ–‡)</option>
                        <option value="3:4">3:4 (ç›´å¼ç…§ç‰‡)</option>
                        <option value="9:16">9:16 (é™å‹•/Reels)</option>
                    </optgroup>
                </select>
            </div>

            <div class="category-card">
                <label class="category-title">ğŸ’ è§£æåº¦ (Resolution)</label>
                <select class="form-select" id="pixelResolution">
                    <option value="" selected>é è¨­</option>
                    <optgroup label="ç¤¾ç¾¤/è¢å¹•">
                        <option value="1080x1080 px, high quality">IG æ­£æ–¹å½¢ (1080p)</option>
                        <option value="3840x2160 px, 4K UHD">4K è¶…é«˜ç•«è³ª</option>
                    </optgroup>
                    <optgroup label="å°åˆ·/æ”å½±">
                        <option value="2480x3508 px, 300DPI">A4 å°åˆ·è¦æ ¼</option>
                        <option value="6000x4000 px, 24MP">2400 è¬åƒç´ </option>
                    </optgroup>
                </select>
            </div>
            
            <div class="text-center text-muted small mt-4 p-3" id="hintText">
                </div>
        </div>

        <div id="page-photo" class="tab-content-area"><div id="container-photo"></div></div>
        <div id="page-art" class="tab-content-area"><div id="container-art"></div></div>
        <div id="page-anime" class="tab-content-area"><div id="container-anime"></div></div>
    </div>

    <div class="app-footer">
        <div class="d-grid gap-2 mb-2">
            <button class="btn btn-primary fw-bold" onclick="generatePrompt()" style="background-color: #4285f4; border-color: #4285f4;">
                âœ¨ ç”¢å‡ºæç¤ºè©
            </button>
        </div>
        <div class="input-group input-group-sm">
            <textarea class="form-control" id="outputPrompt" rows="2" readonly placeholder="æç¤ºè©å°‡é¡¯ç¤ºæ–¼æ­¤" style="resize: none; font-size: 0.85rem;"></textarea>
            <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard()">è¤‡è£½</button>
        </div>
    </div>

<script>
    // Imgur Client ID (åƒ…åœ¨ MJ æ¨¡å¼ä¸‹éœ€è¦)
    const IMGUR_CLIENT_ID = 'e290885e3477163'; 
    let currentModel = 'gemini'; // é è¨­æ”¹ç‚º Gemini æ¨¡å¼ (æ›´ç¬¦åˆæ‚¨çš„éœ€æ±‚)

    // --- 1. æ¨¡å‹åˆ‡æ›é‚è¼¯ ---
    function setModel(model) {
        currentModel = model;
        
        // æ›´æ–°æŒ‰éˆ•æ¨£å¼
        document.getElementById('btn-mj').classList.toggle('active', model === 'mj');
        document.getElementById('btn-gemini').classList.toggle('active', model === 'gemini');

        // æ›´æ–°ä»‹é¢é¡¯ç¤º
        const body = document.body;
        const hintText = document.getElementById('hintText');
        const uploadStatus = document.getElementById('uploadStatus');

        if (model === 'gemini') {
            body.classList.add('gemini-mode');
            hintText.innerHTML = `
                <div style="background: #e8f0fe; padding: 10px; border-radius: 8px; color: #1967d2;">
                    <strong>ğŸ“ Gemini æ•™è‚²ç‰ˆæ¨¡å¼</strong><br>
                    1. ç”¨ä¸Šæ–¹ ğŸ“¸ æ‹ç…§ (åƒ…é è¦½ï¼Œä¸ä¸Šå‚³)ã€‚<br>
                    2. æŒ‰ã€Œç”¢å‡ºæç¤ºè©ã€ä¸¦è¤‡è£½ã€‚<br>
                    3. åˆ° Gemini è²¼ä¸Šæ–‡å­—ï¼Œä¸¦<b>ç›´æ¥ä¸Šå‚³ç…§ç‰‡</b>ã€‚
                </div>`;
            uploadStatus.style.display = 'none';
        } else {
            body.classList.remove('gemini-mode');
            hintText.innerHTML = `
                <div style="background: #f1f3f4; padding: 10px; border-radius: 8px; color: #5f6368;">
                    <strong>Midjourney æ¨¡å¼</strong><br>
                    æ‹ç…§å¾Œæœƒè‡ªå‹•ä¸Šå‚³è‡³åœ–åºŠè½‰æˆç¶²å€ï¼Œé©åˆ MJ æˆ– Discord ä½¿ç”¨ã€‚
                </div>`;
            if(document.getElementById('imgPreview').src) {
                uploadStatus.style.display = 'block';
            }
        }
    }

    // --- 2. åœ–ç‰‡è™•ç† (æ•´åˆé‚è¼¯) ---
    async function handleImageSelect(input) {
        if (!input.files || !input.files[0]) return;
        const file = input.files[0];

        // é¡¯ç¤ºæœ¬åœ°é è¦½ (é›™æ¨¡å¼éƒ½è¦)
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('imgPreview').src = e.target.result;
            document.getElementById('previewContainer').style.display = 'block';
        }
        reader.readAsDataURL(file);

        // å¦‚æœæ˜¯ MJ æ¨¡å¼ï¼Œæ‰åŸ·è¡Œä¸Šå‚³
        if (currentModel === 'mj') {
            const statusEl = document.getElementById('uploadStatus');
            const urlInput = document.getElementById('uploadedImageUrl');
            
            statusEl.style.display = 'block';
            statusEl.style.color = '#0d6efd';
            statusEl.innerHTML = 'â˜ï¸ è½‰ç¶²å€ä¸­...';
            
            const formData = new FormData();
            formData.append('image', file);

            try {
                const response = await fetch('https://api.imgur.com/3/image', {
                    method: 'POST',
                    headers: { Authorization: `Client-ID ${IMGUR_CLIENT_ID}` },
                    body: formData
                });
                const data = await response.json();
                if (data.success) {
                    urlInput.value = data.data.link;
                    statusEl.innerHTML = 'âœ… ç¶²å€å·²å°±ç·’';
                    statusEl.style.color = 'green';
                } else { throw new Error('Upload failed'); }
            } catch (error) {
                console.error(error);
                statusEl.innerHTML = 'âŒ ä¸Šå‚³å¤±æ•—';
                statusEl.style.color = 'red';
            }
        }
    }

    function removeImage() {
        document.getElementById('cameraInput').value = "";
        document.getElementById('uploadedImageUrl').value = "";
        document.getElementById('previewContainer').style.display = 'none';
        document.getElementById('uploadStatus').style.display = 'none';
        document.getElementById('imgPreview').src = "";
    }

    // --- 3. ç”¢å‡ºæç¤ºè© (æ ¸å¿ƒå·®ç•°) ---
    async function generatePrompt() {
        let mainSubject = document.getElementById('mainSubject').value.trim();
        const aspectRatio = document.getElementById('aspectRatio').value;
        const pixelRes = document.getElementById('pixelResolution').value;
        const uploadedImageUrl = document.getElementById('uploadedImageUrl').value;
        // æª¢æŸ¥æ˜¯å¦æœ‰é¸æ“‡åœ–ç‰‡ (cameraInput æœ‰æª”æ¡ˆ æˆ– é è¦½åœ–æœ‰ src)
        const hasLocalImage = document.getElementById('cameraInput').files.length > 0 || document.getElementById('imgPreview').getAttribute('src') !== "";
        const btn = document.querySelector('.btn-primary');

        if (/[\u4e00-\u9fa5]/.test(mainSubject)) {
            const originalText = btn.textContent;
            btn.textContent = "â³ ç¿»è­¯ä¸­...";
            btn.disabled = true;
            mainSubject = await translateInput() || mainSubject;
            btn.textContent = originalText;
            btn.disabled = false;
        }

        let parts = [];

        // === Gemini æ¨¡å¼ (é‡å°æ€è€ƒæ¨¡å‹å„ªåŒ–) ===
        if (currentModel === 'gemini') {
            // çµæ§‹åŒ– Promptï¼Œå¼•å°æ€è€ƒæ¨¡å‹
            if (hasLocalImage) {
                // æœ‰åœ–ï¼šè¦æ±‚åˆ†æåœ–ç‰‡
                parts.push("Step 1: Analyze the attached reference image for pose, composition, and main features.");
                parts.push("Step 2: Generate a NEW image maintaining that composition, but applying the following styles:");
            } else {
                // ç„¡åœ–ï¼šç›´æ¥ç”Ÿæˆ
                parts.push("Generate an image with the following description:");
            }
            
            if (mainSubject) parts.push(`Subject: ${mainSubject}.`);
            
            // æ”¶é›†é¢¨æ ¼
            let styles = [];
            collectSelects(styles);
            if (styles.length > 0) {
                parts.push(`Art Style & Details: ${styles.join(', ')}.`);
            }

            if (pixelRes) parts.push(`Quality: ${pixelRes}.`);
            if (aspectRatio) parts.push(`Aspect Ratio: ${aspectRatio}.`);
            
            parts.push("Ensure high aesthetic quality and accurate adherence to the style.");
        } 
        
        // === Midjourney æ¨¡å¼ ===
        else {
            if (uploadedImageUrl) parts.push(uploadedImageUrl); 
            if (mainSubject) parts.push(mainSubject);
            if (pixelRes) parts.push(pixelRes);
            collectSelects(parts);
            parts.push("--v 6.0");
            if (aspectRatio) parts.push(`--ar ${aspectRatio}`);
        }

        document.getElementById('outputPrompt').value = parts.join(' ');
    }

    function collectSelects(array) {
        document.querySelectorAll('.category-select').forEach(select => {
            if (select.value && !select.disabled) {
                array.push(select.value);
            }
        });
    }

    // --- è¼”åŠ©åŠŸèƒ½ ---
    function switchTab(btn, targetId) {
        if (btn.classList.contains('disabled-tab')) return;
        document.querySelectorAll('.nav-link').forEach(b => {
            b.classList.remove('active'); b.style.backgroundColor='#f8f9fa'; b.style.color='#6c757d';
        });
        btn.classList.add('active'); btn.style.backgroundColor='#4285f4'; btn.style.color='white';
        document.querySelectorAll('.tab-content-area').forEach(div => div.classList.remove('active'));
        document.getElementById(targetId).classList.add('active');
    }

    async function translateInput() {
        const text = document.getElementById('mainSubject').value.trim();
        if (!text || !/[\u4e00-\u9fa5]/.test(text)) return text;
        try {
            const res = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=zh-TW|en`);
            const data = await res.json();
            if (data.responseData?.translatedText) {
                document.getElementById('mainSubject').value = data.responseData.translatedText;
                return data.responseData.translatedText;
            }
        } catch (e) { console.error(e); }
    }

    function copyToClipboard() {
        const el = document.getElementById("outputPrompt");
        el.select(); el.setSelectionRange(0, 99999);
        navigator.clipboard.writeText(el.value);
    }

    // --- å®Œæ•´è³‡æ–™åº« (å…¨æ”¶éŒ„) ---
    const categorizedData = {
        "photo": { 
            "æ”å½±é¡å‹ (Types)": [
                { id: "photo_type", val: "photo", label: "ç…§ç‰‡ (photo)"}, 
                { id: "photo_type", val: "photography", label: "æ”å½± (photography)"},
                { id: "photo_type", val: "life photo", label: "ç”Ÿæ´»ç…§ (life photo)"}, 
                { id: "photo_type", val: "group photo", label: "åœ˜é«”ç…§ (group photo)"},
                { id: "photo_type", val: "selfie photo", label: "è‡ªæ‹ç…§ (selfie photo)"}, 
                { id: "photo_type", val: "portrait photography", label: "äººåƒæ”å½± (portrait)"}, 
                { id: "photo_type", val: "sports photography", label: "é‹å‹•æ”å½± (sports)"},
                { id: "photo_type", val: "still life photo", label: "éœç‰©æ”å½± (still life)"}
            ],
            "å…‰åœˆ (Aperture)": [
                { id: "photo_aperture", val: "f/1.4", label: "f/1.4"}, { id: "photo_aperture", val: "f/2.8", label: "f/2.8"},
                { id: "photo_aperture", val: "f/8", label: "f/8"}, { id: "photo_aperture", val: "f/16", label: "f/16"}
            ],
            "ç„¦è· (Focal Length)": [
                { id: "photo_focal", val: "24mm", label: "24mm"}, { id: "photo_focal", val: "35mm", label: "35mm"},
                { id: "photo_focal", val: "85mm", label: "85mm"}, { id: "photo_focal", val: "200mm", label: "200mm"}
            ],
            "ç’°å¢ƒèˆ‡ç•«è³ªè¼”åŠ© (Auxiliary)": [
                { val: "bright", label: "ç’°å¢ƒè¼ƒæ˜äº®"}, { val: "dark", label: "ç’°å¢ƒè¼ƒæš—"},
                { val: "realistic", label: "é€¼çœŸ"}, { val: "b/w", label: "é»‘ç™½ç…§ç‰‡"},
                { val: "very realistic", label: "éå¸¸é€¼çœŸ"}, { val: "very detailed", label: "é«˜ç´°ç¯€"},
                { val: "8K", label: "8K ç•«è³ª"}
            ],
            "æ”å½±é¢¨æ ¼ (Styles)": [
                {val: "DSLR style", label: "æ•¸ä½å–®çœ¼"}, {val: "Polaroid style", label: "æ‹ç«‹å¾—"},
                {val: "gopro style", label: "GoPro"}, {val: "Fujifilm superia style", label: "å¯Œå£«åº•ç‰‡"},
                {val: "LOMO style", label: "LOMO"}, {val: "movie style", label: "é›»å½±é¢¨"},
                {val: "cinematic photo style", label: "åŠ‡ç…§"}, {val: "vintage photo style", label: "å¾©å¤"},
                {val: "Holga photography", label: "Holga ç›¸æ©Ÿ"}, {val: "Anthotype print", label: "æ¤ç‰©æ„Ÿå…‰"}
            ],
            "é¡é ­èˆ‡å…‰å½± (Lens/Light)": [
                {val: "macro lens", label: "å¾®è·é¡é ­"}, {val: "wide angle lens", label: "å»£è§’é¡é ­"},
                {val: "fish eye lens", label: "é­šçœ¼é¡é ­"}, {val: "bokeh", label: "æ•£æ™¯/æ™¯æ·±"},
                {val: "lens flare", label: "é¡é ­çœ©å…‰"}, {val: "golden hour", label: "é»ƒé‡‘æ™‚åˆ»"},
                {val: "ambient light", label: "ç’°å¢ƒå…‰"}, {val: "hard light", label: "ç¡¬å…‰"},
                {val: "soft light", label: "æŸ”å…‰"}, {val: "rim light", label: "è¼ªå»“å…‰"},
                {val: "multiple exposure", label: "é‡è¤‡æ›å…‰"}, {val: "HDR", label: "HDR"}
            ],
            "ç•«é¢è§’åº¦ (Angles)": [
                {val: "face close-up", label: "è‡‰éƒ¨ç‰¹å¯«"}, {val: "full body shot", label: "å…¨èº«ç…§"},
                {val: "low angle view", label: "ä½è§’åº¦"}, {val: "high angle view", label: "é«˜è§’åº¦"},
                {val: "bird view", label: "é³¥ç°"}, {val: "knolling", label: "é–‹ç®±ç…§"},
                {val: "product view", label: "ç”¢å“ç‰¹å¯«"}, {val: "360 degrees photo", label: "360åº¦ç…§ç‰‡"}
            ]
        },
        "art": { 
            "ç¹ªç•«åª’æ (Mediums)": [
                {val: "illustration", label: "æ’ç•«"}, {val: "pencil", label: "é‰›ç­†ç•«"},
                {val: "charcoal", label: "ç‚­ç­†ç•«"}, {val: "color pencil", label: "è‰²é‰›ç­†"},
                {val: "acrylic painting", label: "å£“å…‹åŠ›ç•«"}, {val: "watercolor painting", label: "æ°´å½©ç•«"},
                {val: "oil painting", label: "æ²¹ç•«"}, {val: "ink drawing", label: "æ°´å¢¨ç•«"},
                {val: "Woodcut", label: "æœ¨åˆ»ç‰ˆç•«"}, {val: "vector art", label: "å‘é‡åœ–"}
            ],
            "ç‰¹æ®Šæè³ª (Materials)": [
                {val: "paper art", label: "ç´™é›•"}, {val: "origami art", label: "æ‘ºç´™"},
                {val: "stained glass", label: "å½©ç¹ªç»ç’ƒ"}, {val: "pixel art", label: "åƒç´ ç•«"},
                {val: "Low poly", label: "ä½å¤šé‚Šå½¢"}, {val: "wood carving", label: "æœ¨é›•"},
                {val: "lego", label: "æ¨‚é«˜"}, {val: "felt doll", label: "ç¾Šæ¯›æ°ˆ"},
                {val: "neon light", label: "éœ“è™¹ç‡ˆ"}, {val: "ASCII art", label: "ASCII ä»£ç¢¼"}
            ],
            "è—è¡“æµæ´¾ (Movements)": [
                {val: "Impressionnisme", label: "å°è±¡æ´¾"}, {val: "Surrealism", label: "è¶…ç¾å¯¦ä¸»ç¾©"},
                {val: "Cubism", label: "ç«‹é«”ä¸»ç¾©"}, {val: "Pop Art", label: "æ™®æ™®è—è¡“"},
                {val: "Minimalism", label: "æ¥µç°¡ä¸»ç¾©"}, {val: "Cyber Art", label: "è³½åšè—è¡“"},
                {val: "Steampunk", label: "è’¸æ°£é¾å…‹"}, {val: "Ukiyo-e", label: "æµ®ä¸–ç¹ª"}
            ],
            "è—è¡“å®¶ (Artists)": [
                {val: "Vincent van Gogh", label: "æ¢µè°·"}, {val: "Leonardo da Vinci", label: "é”æ–‡è¥¿"},
                {val: "Picasso", label: "ç•¢å¡ç´¢"}, {val: "Dali", label: "é”åˆ©"},
                {val: "Monet", label: "è«å…§"}, {val: "Mucha", label: "æ…•å¤"},
                {val: "Andy Warhol", label: "å®‰è¿ªæ²ƒè·"}, {val: "Hayao Miyazaki", label: "å®®å´é§¿"},
                {val: "Makoto Shinkai", label: "æ–°æµ·èª "}
            ]
        },
        "anime": { 
            "å‹•æ¼«é¡å‹ (Types)": [
                {val: "2D cartoon", label: "2D å¡é€š"}, {val: "3D cartoon", label: "3D å¡é€š"},
                {val: "Anime style", label: "æ—¥ç³»å‹•ç•«"}, {val: "American comic book", label: "ç¾å¼æ¼«ç•«"}
            ],
            "å‹•ç•«å…¬å¸ (Studios)": [
                {val: "Pixar Animation", label: "çš®å…‹æ–¯"}, {val: "DreamWorks Animation", label: "å¤¢å·¥å» "},
                {val: "Disney Animation", label: "è¿ªå£«å°¼"}, {val: "Ghibli Studio", label: "å‰åœåŠ›"},
                {val: "Kyoto Animation", label: "äº¬éƒ½å‹•ç•«"}, {val: "Marvel Animation", label: "æ¼«å¨"}
            ],
            "å‹•æ¼«ä½œå“ (Series)": [
                {val: "One Piece", label: "èˆªæµ·ç‹"}, 
                {val: "Detective Conan", label: "ååµæ¢æŸ¯å—"},
                {val: "Naruto", label: "ç«å½±å¿è€…"},
                {val: "Slam Dunk", label: "çŒç±ƒé«˜æ‰‹"},
                {val: "style of Mitsuru Adachi", label: "å®‰é”å……é¢¨æ ¼"},
                {val: "Fist of the North Star", label: "åŒ—æ–—ç¥æ‹³"},
                {val: "Saint Seiya", label: "è–é¬¥å£«æ˜ŸçŸ¢"},
                {val: "A Certain Scientific Railgun", label: "æŸç§‘å­¸çš„è¶…é›»ç£ç ²"},
                {val: "SpongeBob", label: "æµ·ç¶¿å¯¶å¯¶"}, 
                {val: "Mickey Mouse", label: "ç±³è€é¼ "},
                {val: "The Simpsons", label: "è¾›æ™®æ£®å®¶æ—"}, 
                {val: "Dragon ball", label: "ä¸ƒé¾ç "},
                {val: "Doraemon", label: "å“†å•¦Aå¤¢"}, 
                {val: "Sailor Moon", label: "ç¾å°‘å¥³æˆ°å£«"},
                {val: "kimetsu no Yaiba", label: "é¬¼æ»…ä¹‹åˆƒ"}, 
                {val: "JoJo", label: "JoJo"}
            ],
            "è¨­è¨ˆèˆ‡çµæ§‹ (Design)": [
                {val: "mascot logo", label: "å‰ç¥¥ç‰© Logo"}, {val: "UI design", label: "UI ä»‹é¢"},
                {val: "3D Model Exploded View", label: "3D åˆ†è§£åœ–"}, {val: "2D floor plan", label: "2D å¹³é¢åœ–"},
                {val: "character toy", label: "å…¬ä»”ç©å…·"}
            ]
        }
    };

    function init() {
        for (const [tabKey, categories] of Object.entries(categorizedData)) {
            const container = document.getElementById(`container-${tabKey}`);
            if (!container) continue;
            for (const [catName, items] of Object.entries(categories)) {
                const card = document.createElement('div'); card.className = 'category-card';
                const label = document.createElement('label'); label.className = 'category-title'; label.textContent = catName;
                card.appendChild(label);
                const select = document.createElement('select'); select.className = 'form-select category-select';
                if (items.length > 0 && items[0].id) select.id = items[0].id;
                select.appendChild(new Option("ä¸æŒ‡å®š", ""));
                items.forEach(item => select.appendChild(new Option(item.label, item.val)));
                card.appendChild(select);
                container.appendChild(card);
            }
        }
        
        // ç¶å®šæ’ä»–é‚è¼¯
        const photoType = document.getElementById('photo_type');
        if (photoType) {
            photoType.addEventListener('change', function() {
                const isPhoto = this.value !== "";
                ['photo_aperture', 'photo_focal'].forEach(id => {
                    const el = document.getElementById(id);
                    if(el) { el.disabled = !isPhoto; if(!isPhoto) el.value=""; }
                });
                toggleLock('container-art', 'btn-art', isPhoto);
                toggleLock('container-anime', 'btn-anime', isPhoto);
            });
        }
        // åˆå§‹ç‹€æ…‹é–å®š
        ['photo_aperture', 'photo_focal'].forEach(id => { const el = document.getElementById(id); if(el) el.disabled = true; });
        
        // åˆå§‹åŒ–é è¨­ç‚º Gemini
        setModel('gemini');
    }

    function toggleLock(cid, bid, lock) {
        const c = document.getElementById(cid), b = document.getElementById(bid);
        c.querySelectorAll('select').forEach(s => { s.disabled = lock; if(lock) s.value=""; });
        b.classList.toggle('disabled-tab', lock);
        c.querySelectorAll('.category-card').forEach(card => card.classList.toggle('disabled-card', lock));
        b.querySelector('.locked-badge').style.display = lock ? 'inline-block' : 'none';
    }

    init();
    if ('serviceWorker' in navigator) window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
</script>
</body>
</html>
