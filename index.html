<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ICS Lab Pro - V6.1 All-in-One</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = { darkMode: 'media' }
    </script>

    <style>
        body { -webkit-tap-highlight-color: transparent; transition: background-color 0.4s ease; }
        .app-card { border-radius: 32px; transition: all 0.3s ease; }
        .gradient-header { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }
        @media (prefers-color-scheme: dark) { body { background-color: #0f172a; } }
        .dot { transition: all 0.3s ease-in-out; }
        input:checked ~ .dot { transform: translateX(100%); background-color: #4f46e5; }
        @keyframes dice-roll { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .rolling { animation: dice-roll 0.5s ease-in-out; }
        select { appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 1.2rem center; background-repeat: no-repeat; background-size: 1.2em; }
        .mode-btn-active { @apply ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 font-bold !important; }
    </style>
</head>
<body class="p-4 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans pb-10 flex justify-center items-start">

    <div class="w-full max-w-md bg-white dark:bg-slate-800 app-card shadow-2xl overflow-hidden border border-gray-100 dark:border-slate-700">
        <div class="p-9 gradient-header text-white relative">
            <h1 class="text-3xl font-black flex items-center gap-3 relative z-10">
                <i class="fas fa-wand-sparkles text-yellow-300"></i> ICS Lab Pro
            </h1>
            <p class="text-indigo-100 text-[10px] mt-2 font-bold tracking-[0.3em] opacity-90 uppercase relative z-10">V6.1 Ultimate Integration</p>
            
            <button onclick="randomStyleOnly()" class="absolute bottom-6 right-6 bg-white/20 hover:bg-white/30 backdrop-blur-md p-3 rounded-2xl border border-white/30 transition-all active:scale-90 group shadow-lg">
                <i id="diceIcon" class="fas fa-dice text-2xl text-white group-hover:rotate-12 transition-transform"></i>
            </button>
        </div>

        <div class="p-7 space-y-8">
            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-4 block tracking-[0.2em] uppercase">Step 00. å‰µä½œæ¨¡å¼ (Mode)</label>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="vibrate(); setMode('é€šç”¨', this)" class="mode-btn mode-btn-active border border-gray-100 dark:border-slate-700 p-2 rounded-xl text-[10px] font-medium transition-all">é€šç”¨</button>
                    <button onclick="vibrate(); setMode('äººåƒ', this)" class="mode-btn border border-gray-100 dark:border-slate-700 p-2 rounded-xl text-[10px] font-medium transition-all">äººåƒ</button>
                    <button onclick="vibrate(); setMode('é¢¨æ™¯', this)" class="mode-btn border border-gray-100 dark:border-slate-700 p-2 rounded-xl text-[10px] font-medium transition-all">é¢¨æ™¯</button>
                    <button onclick="vibrate(); setMode('å‹•æ¼«', this)" class="mode-btn border border-gray-100 dark:border-slate-700 p-2 rounded-xl text-[10px] font-medium transition-all">å‹•æ¼«</button>
                    <button onclick="vibrate(); setMode('LOGO', this)" class="mode-btn border border-gray-100 dark:border-slate-700 p-2 rounded-xl text-[10px] font-medium transition-all">LOGO</button>
                    <button onclick="vibrate(); setMode('è¶…ç¾å¯¦', this)" class="mode-btn border border-gray-100 dark:border-slate-700 p-2 rounded-xl text-[10px] font-medium transition-all">è¶…ç¾å¯¦</button>
                </div>
            </section>

            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-4 block tracking-[0.2em] uppercase">Step 01. åœ–ç‰‡é¡å‹ (I)</label>
                <div class="grid grid-cols-2 gap-3">
                    <button id="btn-infographic" onclick="vibrate(); setType('infographic', this)" class="type-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-4 rounded-2xl text-indigo-700 dark:text-indigo-300 text-sm font-bold transition-all shadow-sm">è³‡è¨Šåœ–è¡¨</button>
                    <button id="btn-diagram" onclick="vibrate(); setType('diagram', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-4 rounded-2xl text-gray-500 dark:text-slate-400 text-sm font-medium transition-all">åŠŸèƒ½åœ–è§£</button>
                    <button id="btn-flowchart" onclick="vibrate(); setType('flowchart', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-4 rounded-2xl text-gray-500 dark:text-slate-400 text-sm font-medium transition-all">æµç¨‹åœ–</button>
                    <button id="btn-timeline" onclick="vibrate(); setType('timeline', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-4 rounded-2xl text-gray-500 dark:text-slate-400 text-sm font-medium transition-all">æ™‚é–“è»¸</button>
                </div>
            </section>

            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-4 block tracking-[0.2em] uppercase">Step 02. å…§å®¹ä¸»é¡Œ (C)</label>
                <textarea id="content" rows="2" placeholder="è¼¸å…¥ä½ æƒ³å‘ˆç¾çš„ä¸»é¡Œ..." 
                       class="w-full p-5 bg-gray-50 dark:bg-slate-900/50 border border-gray-100 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-indigo-500 outline-none text-gray-700 dark:text-slate-200 transition-all text-base shadow-inner"></textarea>
            </section>

            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-4 block tracking-[0.2em] uppercase">Step 03. è¦–è¦ºé¢¨æ ¼ (S - 32ç¨®)</label>
                <select id="style" onchange="vibrate(); updatePreview()" class="w-full p-5 bg-gray-50 dark:bg-slate-900/50 border border-gray-100 dark:border-slate-700 rounded-2xl font-bold text-gray-700 dark:text-slate-200 mb-5 outline-none text-base shadow-sm">
                    <option value="" disabled selected>è«‹é¸æ“‡é¢¨æ ¼...</option>
                    <optgroup label="ğŸ’¼ å°ˆæ¥­å•†å‹™">
                        <option value="McKinsey">01 é¡§å•é¢¨ McKinsey</option>
                        <option value="Corporate">02 ä¼æ¥­é¢¨ Corporate</option>
                        <option value="Minimalist">03 æ¥µç°¡é¢¨ Minimalist</option>
                        <option value="Professional">04 ç°¡å ±é¢¨ Professional</option>
                        <option value="Framework">05 åœ–è¡¨é¢¨ Framework</option>
                    </optgroup>
                    <optgroup label="ğŸ¨ æ’ç•«è—è¡“">
                        <option value="Watercolor">06 æ°´å½©é¢¨ Watercolor</option>
                        <option value="Isometric 3D">07 ç­‰è·é¢¨ Isometric 3D</option>
                        <option value="Flat Vector">08 æ‰å¹³é¢¨ Flat Vector</option>
                        <option value="Kawaii">09 å¯æ„›é¢¨ Kawaii</option>
                        <option value="Hand-drawn Sketch">10 æ‰‹ç¹ªé¢¨ Hand-drawn</option>
                        <option value="Paper Cutout">11 å‰ªç´™é¢¨ Paper Cutout</option>
                    </optgroup>
                    <optgroup label="ğŸ® è¶£å‘³å‰µæ„">
                        <option value="Anime">12 å‹•æ¼«é¢¨ Anime</option>
                        <option value="Comic Book">13 æ¼«ç•«é¢¨ Comic Book</option>
                        <option value="Pixel Art">14 åƒç´ é¢¨ Pixel Art</option>
                        <option value="Claymation">15 é»åœŸé¢¨ Claymation</option>
                        <option value="Origami">16 æ‘ºç´™é¢¨ Origami</option>
                        <option value="Graffiti">17 å¡—é´‰é¢¨ Graffiti</option>
                    </optgroup>
                    <optgroup label="ğŸ“œ å¾©å¤ç¶“å…¸">
                        <option value="Vintage Poster">18 æµ·å ±é¢¨ Vintage Poster</option>
                        <option value="Chalkboard">19 é»‘æ¿é¢¨ Chalkboard</option>
                        <option value="Analog Film">20 åº•ç‰‡é¢¨ Analog Film</option>
                        <option value="Pop Art">21 æ™®æ™®é¢¨ Pop Art</option>
                        <option value="Da Vinci">22 é”æ–‡è¥¿ Da Vinci</option>
                    </optgroup>
                    <optgroup label="ğŸ”¬ æŠ€è¡“åœ–è§£">
                        <option value="Blueprint">23 è—åœ–é¢¨ Blueprint</option>
                        <option value="Cross-section">24 å‰–é¢åœ– Cross-section</option>
                        <option value="Wireframe">25 ç·šæ¡†åœ– Wireframe</option>
                        <option value="Subway Map">26 åœ°éµåœ– Subway Map</option>
                    </optgroup>
                    <optgroup label="âœ¨ ç‰¹æ®Šé¢¨æ ¼">
                        <option value="Cyberpunk">27 è³½åšé¾å…‹ Cyberpunk</option>
                        <option value="Steampunk">28 è’¸æ°£é¾å…‹ Steampunk</option>
                        <option value="Quilling">29 ç´™é›•é¢¨ Quilling</option>
                        <option value="Flat Lay">30 æ”å½±é¢¨ Flat Lay</option>
                        <option value="Glassmorphism">31 ç»ç’ƒé¢¨ Glassmorphism</option>
                        <option value="Diorama">32 å°å±‹é¢¨ Diorama</option>
                    </optgroup>
                </select>

                <div id="previewCard" class="hidden p-5 rounded-2xl bg-indigo-50 dark:bg-slate-900 border border-indigo-100 dark:border-slate-700 animate-in fade-in slide-in-from-top-2 duration-300">
                    <p id="previewText" class="text-xs text-indigo-700 dark:text-indigo-300 leading-relaxed font-bold"></p>
                </div>
            </section>

            <button onclick="vibrate(); generate()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-black py-4 rounded-2xl shadow-xl transition-all active:scale-[0.96] flex justify-center items-center gap-2 text-lg">
                ç”ŸæˆæŒ‡ä»¤ <i class="fas fa-magic"></i>
            </button>

            <div id="resultBox" class="hidden animate-in zoom-in-95 duration-300">
                <div class="bg-slate-900 rounded-[2rem] p-7 border border-slate-700 shadow-2xl relative">
                    <p id="finalPrompt" class="text-indigo-200 text-xs font-mono whitespace-pre-line leading-relaxed bg-slate-950/50 p-5 rounded-2xl border border-white/5 shadow-inner mb-6"></p>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="vibrate(); copyText()" class="bg-indigo-600 text-white p-4 rounded-xl text-xs font-black transition active:scale-90 flex flex-col items-center gap-1">
                            <i class="far fa-copy text-lg"></i> è¤‡è£½
                        </button>
                        <button onclick="vibrate(); shareLine()" class="bg-[#06C755] text-white p-4 rounded-xl text-xs font-black transition active:scale-90 flex flex-col items-center gap-1">
                            <i class="fab fa-line text-lg"></i> LINE
                        </button>
                        <button onclick="vibrate(); shareFB()" class="bg-[#1877F2] text-white p-4 rounded-xl text-xs font-black transition active:scale-90 flex flex-col items-center gap-1">
                            <i class="fab fa-facebook text-lg"></i> FB
                        </button>
                    </div>
                </div>
            </div>

            <section id="historySection" class="pt-6">
                <div class="flex items-center justify-between mb-4 px-1">
                    <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest">æ­·å²ç´€éŒ„ (5ç­†)</label>
                    <button onclick="vibrate(); clearHistory()" class="text-[10px] font-bold text-indigo-500">æ¸…é™¤ç´€éŒ„</button>
                </div>
                <div id="historyList" class="space-y-3"></div>
            </section>
        </div>
    </div>

    <script>
        // æ ¹æ“š 32 ç¨®é¢¨æ ¼æ¸…å–®å»ºç«‹å­—å…¸
        const styleSpecs = {
            "McKinsey": { spec: "Professional business framework, corporate blue.", desc: "é¡§å•å°ˆæ¥­é¢¨ï¼šç¶“å…¸å•†å‹™è—ï¼Œå¼·èª¿æ•¸æ“šé‚è¼¯ã€‚" },
            "Corporate": { spec: "Modern office aesthetic, polished branding.", desc: "ä¼æ¥­è³ªæ„Ÿé¢¨ï¼šé©åˆç§‘æŠ€ç”¢å“ä»‹ç´¹ã€‚" },
            "Minimalist": { spec: "Clean white space, high contrast.", desc: "æ¥µç°¡ç¾å­¸ï¼šå¤§é‡ç•™ç™½ï¼Œè¦–è¦ºç„¦é»é›†ä¸­ã€‚" },
            "Professional": { spec: "Clean slide design, balanced typography.", desc: "å°ˆæ¥­ç°¡å ±ï¼šæ’ç‰ˆè¦æ•´ï¼Œé©åˆå·¥ä½œå ±å‘Šã€‚" },
            "Framework": { spec: "Logical flow, systematic arrangement.", desc: "é‚è¼¯æ¡†æ¶ï¼šæ¸…æ™°çš„æ¨¡çµ„åŒ–æ’ç‰ˆæ–¹å¼ã€‚" },
            "Watercolor": { spec: "Soft watercolor wash, artistic edges.", desc: "æ‰‹ç¹ªæ°´å½©ï¼šæµªæ¼«ä¸”å…·è—è¡“æ„Ÿçš„ç­†è§¸ã€‚" },
            "Isometric 3D": { spec: "30-degree isometric perspective, stacked cubic/geometric shapes, clear shadow layers for depth, video game map aesthetic, tech-forward modern colors.", desc: "ç­‰è·è¦–è§’ï¼š30åº¦ç«‹é«”å †ç–Šï¼Œç§‘æŠ€æ„Ÿå¼·ã€‚" },
            "Flat Vector": { spec: "2D flat design, bold modern colors.", desc: "æ‰å¹³æ’ç•«ï¼šç°¡æ½”æ˜äº®ï¼Œé©åˆç¶²é è¨­è¨ˆã€‚" },
            "Kawaii": { spec: "Cute characters, pastel colors.", desc: "å¯æ„›æ’ç•«ï¼šç²‰è‰²èª¿ã€åœ“æ½¤ï¼Œå…·è¦ªå’ŒåŠ›ã€‚" },
            "Hand-drawn Sketch": { spec: "Pencil line texture, organic irregular shapes, rough sketch edges, notebook paper style, casual and approachable mood.", desc: "è‰åœ–æ‰‹å¯«ï¼šè¦ªåˆ‡è‡ªç„¶ï¼Œå…·æ‰‹å¯«æº«åº¦ã€‚" },
            "Paper Cutout": { spec: "Layered paper, subtle drop shadows.", desc: "å±¤æ¬¡å‰ªç´™ï¼šé€éé™°å½±å‰µé€ æ‰‹å·¥ç«‹é«”æ„Ÿã€‚" },
            "Anime": { spec: "High-quality anime art style, vibrant colors, expressive characters, cel-shaded details.", desc: "ç²¾ç¾å‹•æ¼«ï¼šé«˜é£½å’Œè‰²å½©ï¼Œå……æ»¿æ´»åŠ›ã€‚" },
            "Comic Book": { spec: "Bold ink lines, halftone dots.", desc: "ç¾å¼æ¼«ç•«ï¼šç²—ç·šæ¢ã€ç¶²é»ï¼Œå¼µåŠ›åè¶³ã€‚" },
            "Pixel Art": { spec: "16-bit retro style, pixel grid.", desc: "åƒç´ è—è¡“ï¼šæ‡·èˆŠéŠæˆ²æ„Ÿï¼Œæ•¸ä½å¾©å¤ç¾ã€‚" },
            "Claymation": { spec: "3D clay texture, visible fingerprints on surface, soft plasticine lighting, stop-motion animation aesthetic, warm and tactile feel.", desc: "é»åœŸå®šæ ¼ï¼šæº«æ½¤è³ªæ„Ÿï¼Œå¯è¦‹æ‰‹å·¥ç—•è·¡ã€‚" },
            "Origami": { spec: "Folded paper, sharp creases.", desc: "ç´°è†©æ‘ºç´™ï¼šå¹¾ä½•å°ç¨±ï¼Œç´”æ·¨ç´™è³ªç¾ã€‚" },
            "Graffiti": { spec: "Street art, spray paint texture.", desc: "è¡—é ­å¡—é´‰ï¼šé®®è±”å¥”æ”¾ï¼Œå…·å‚™éƒ½å¸‚é…·æ„Ÿã€‚" },
            "Vintage Poster": { spec: "Retro aesthetic, weathered paper.", desc: "å¾©å¤æµ·å ±ï¼šæ‡·èˆŠé…è‰²ï¼Œå……æ»¿æ­²æœˆè³ªæ„Ÿã€‚" },
            "Chalkboard": { spec: "Chalk texture on black background.", desc: "æ•™å®¤é»‘æ¿ï¼šå…·å‚™æ•™è‚²æ°›åœï¼Œæ‰‹å¯«è¦ªåˆ‡ã€‚" },
            "Analog Film": { spec: "Film grain, light leaks, vintage color.", desc: "è† æ²åº•ç‰‡ï¼šå¾©å¤é¡†ç²’æ„Ÿèˆ‡æº«æš–å…‰å½±ã€‚" },
            "Pop Art": { spec: "High contrast, vibrant colors.", desc: "æ™®æ™®è—è¡“ï¼šå¼·çƒˆå°æ¯”è‰²å½©ï¼Œæ™‚å°šå‰è¡›ã€‚" },
            "Da Vinci": { spec: "Sepia ink, aged parchment sketch.", desc: "é”æ–‡è¥¿æ‰‹ç¨¿ï¼šå¤è€ç´™è³ªèˆ‡ç²¾å¯†çµæ§‹åœ–ã€‚" },
            "Blueprint": { spec: "Technical white lines on cyan grid.", desc: "å·¥ç¨‹è—åœ–ï¼šç²¾ç¢ºã€åš´è¬¹çš„æŠ€è¡“ç¾å­¸ã€‚" },
            "Cross-section": { spec: "Cutaway view, structural analysis.", desc: "ç§‘å­¸å‰–é¢ï¼šæ´æ‚‰äº‹ç‰©å…§éƒ¨ç²¾å¯†æ§‹é€ ã€‚" },
            "Wireframe": { spec: "3D mesh, digital prototyping.", desc: "æ•¸ä½ç·šæ¡†ï¼šæ¥µè‡´çš„ç§‘æŠ€æ„Ÿèˆ‡æœªä¾†æ„Ÿã€‚" },
            "Subway Map": { spec: "Simplification, colorful lines.", desc: "åœ°åœ–è·¯ç¶²ï¼šé©åˆæ¢³ç†è¤‡é›œçš„é—œè¯æ€§ã€‚" },
            "Cyberpunk": { spec: "Neon lights, high-tech grit.", desc: "è³½åšé¾å…‹ï¼šéœ“è™¹è—ç´«è‰²èª¿ï¼Œæœªä¾†å»¢åœŸæ„Ÿã€‚" },
            "Steampunk": { spec: "Victorian machinery, brass gears.", desc: "è’¸æ°£é¾å…‹ï¼šé»ƒéŠ…ã€é½’è¼ªï¼Œæ©Ÿæ¢°ç¾å­¸ã€‚" },
            "Quilling": { spec: "Intricate rolled paper art.", desc: "ç´°ç·»ç´™é›•ï¼šè¤‡é›œçš„æ²ç´™å·¥è—ç«‹é«”æ„Ÿã€‚" },
            "Flat Lay": { spec: "Top-down bird's eye view, arranged real objects, clean light background, DIY aesthetic, organized and visually pleasing layout.", desc: "ä¿¯æ‹æ“ºæ‹ï¼šæ•´é½Šã€ç™‚ç™’çš„ä¿¯è¦–è¦–è§’ã€‚" },
            "Glassmorphism": { spec: "Frosted glass, blurred background.", desc: "ç»ç’ƒæ“¬æ…‹ï¼šç£¨ç ‚åŠé€æ˜å±¤æ¬¡ï¼Œç¾ä»£æ™‚å°šã€‚" },
            "Diorama": { spec: "Miniature scene, tilt-shift effect.", desc: "å¾®ç¸®æ™¯è§€ï¼šåƒç©å…·ä¸€æ¨£çš„å°å°ä¸–ç•Œæ„Ÿã€‚" }
        };

        let currentMode = 'é€šç”¨';
        let selectedType = 'infographic';
        let history = JSON.parse(localStorage.getItem('prompt_history_v61') || '[]');

        function vibrate() { if (navigator.vibrate) navigator.vibrate(15); }

        function setMode(mode, btn) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('mode-btn-active'));
            btn.classList.add('mode-btn-active');
        }

        function setType(type, btn) {
            selectedType = type;
            document.querySelectorAll('.type-btn').forEach(b => {
                b.className = 'type-btn border border-gray-100 dark:border-slate-700 p-4 rounded-2xl text-gray-500 dark:text-slate-400 text-sm font-medium transition-all';
            });
            btn.className = 'type-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-4 rounded-2xl text-indigo-700 dark:text-indigo-300 text-sm font-bold transition-all shadow-sm';
        }

        function randomStyleOnly() {
            vibrate();
            const icon = document.getElementById('diceIcon');
            icon.classList.add('rolling');
            setTimeout(() => icon.classList.remove('rolling'), 500);

            const styleSelect = document.getElementById('style');
            const options = Array.from(styleSelect.querySelectorAll('option')).filter(o => o.value !== "");
            styleSelect.value = options[Math.floor(Math.random() * options.length)].value;
            updatePreview();
        }

        function updatePreview() {
            const style = document.getElementById('style').value;
            const card = document.getElementById('previewCard');
            if(styleSpecs[style]) {
                document.getElementById('previewText').innerText = "âœ¨ " + styleSpecs[style].desc;
                card.classList.remove('hidden');
            }
        }

        function generate() {
            const content = document.getElementById('content').value.trim() || "Amazing AI Art";
            const style = document.getElementById('style').value;
            if(!style) return alert('è«‹å…ˆæŒ‘é¸ä¸€å€‹é¢¨æ ¼ï¼');
            
            const modePrompt = currentMode !== 'é€šç”¨' ? `Scene mode: ${currentMode}. ` : "";
            const prompt = `/imagine prompt: A ${style} style ${selectedType} about '${content}'. \n- ${modePrompt}${styleSpecs[style].spec} \n- Aspect ratio: 9:16 --v 6.0`;
            
            document.getElementById('finalPrompt').innerText = prompt;
            document.getElementById('resultBox').classList.remove('hidden');
            saveToHistory(style, content, prompt);
        }

        function saveToHistory(s, c, p) {
            history.unshift({ style: s, content: c, prompt: p });
            if (history.length > 5) history.pop();
            localStorage.setItem('prompt_history_v61', JSON.stringify(history));
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = history.map((item, index) => `
                <div class="p-4 bg-gray-50 dark:bg-slate-900 rounded-2xl border flex justify-between items-center shadow-sm active:scale-95 transition-all" onclick="loadFromHistory(${index})">
                    <div class="overflow-hidden">
                        <p class="text-[9px] font-black text-indigo-500 uppercase">${item.style}</p>
                        <p class="text-[12px] text-gray-700 dark:text-slate-300 font-bold truncate w-48">${item.content}</p>
                    </div>
                    <i class="fas fa-magic text-[10px] text-indigo-300"></i>
                </div>`).join('');
        }

        function loadFromHistory(i) {
            vibrate();
            const item = history[i];
            document.getElementById('finalPrompt').innerText = item.prompt;
            document.getElementById('resultBox').classList.remove('hidden');
        }

        function clearHistory() { history = []; localStorage.removeItem('prompt_history_v61'); renderHistory(); }
        function copyText() { navigator.clipboard.writeText(document.getElementById('finalPrompt').innerText); alert('æŒ‡ä»¤å·²è¤‡è£½ï¼'); }
        function shareLine() { window.open(`https://line.me/R/msg/text/?${encodeURIComponent(document.getElementById('finalPrompt').innerText)}`); }
        function shareFB() { window.open(`https://www.facebook.com/sharer/sharer.php?u=${window.location.href}`); }

        renderHistory();
    </script>
</body>
</html>
