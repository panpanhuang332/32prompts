<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ICS Lab Pro - V6.8 Bilingual Select</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>tailwind.config = { darkMode: 'media' }</script>
    <style>
        body { -webkit-tap-highlight-color: transparent; transition: background-color 0.4s ease; }
        .app-card { border-radius: 32px; transition: all 0.3s ease; }
        .gradient-header { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }
        @media (prefers-color-scheme: dark) { body { background-color: #0f172a; } }
        @keyframes dice-roll { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .rolling { animation: dice-roll 0.5s ease-in-out; }
        select { appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 1.2rem center; background-repeat: no-repeat; background-size: 1.2em; }
    </style>
</head>
<body class="p-4 bg-slate-50 dark:bg-slate-900 min-h-screen font-sans pb-10 flex justify-center items-start">

    <div class="w-full max-w-md bg-white dark:bg-slate-800 app-card shadow-2xl overflow-hidden border border-gray-100 dark:border-slate-700">
        <div class="p-9 gradient-header text-white relative">
            <h1 class="text-3xl font-black italic flex items-center gap-3 relative z-10">
                <i class="fas fa-layer-group text-yellow-300"></i> ICS Lab Pro
            </h1>
            <p class="text-indigo-100 text-[10px] mt-2 font-bold tracking-[0.3em] opacity-90 uppercase relative z-10">V6.8 Traditional Chinese Refined</p>
            <button onclick="randomStyleOnly()" class="absolute bottom-6 right-6 bg-white/20 hover:bg-white/30 backdrop-blur-md p-3 rounded-2xl border border-white/30 transition-all active:scale-90 group shadow-lg">
                <i id="diceIcon" class="fas fa-dice text-2xl text-white group-hover:rotate-12 transition-transform"></i>
            </button>
        </div>

        <div class="p-7 space-y-8">
            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-3 block tracking-[0.2em] uppercase">Step 01. åœ–ç‰‡é¡å‹</label>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="vibrate(); setType('general', this)" class="type-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-2.5 rounded-xl text-indigo-700 dark:text-indigo-300 text-[10px] font-bold transition-all">é€šç”¨åœ–åƒ</button>
                    <button onclick="vibrate(); setType('infographic', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">è³‡è¨Šåœ–è¡¨</button>
                    <button onclick="vibrate(); setType('diagram', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">åŠŸèƒ½åœ–è§£</button>
                    <button onclick="vibrate(); setType('flowchart', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">æµç¨‹åœ–</button>
                    <button onclick="vibrate(); setType('portrait', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">äººåƒæ”å½±</button>
                    <button onclick="vibrate(); setType('landscape', this)" class="type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all">å£¯é—Šé¢¨æ™¯</button>
                </div>
            </section>

            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-3 block tracking-[0.2em] uppercase">Step 02. å…§å®¹ä¸»é¡Œ</label>
                <textarea id="content" rows="2" placeholder="ä½ æƒ³å‘ˆç¾ä»€éº¼ä¸»é¡Œå…§å®¹..." class="w-full p-4 bg-gray-50 dark:bg-slate-900/50 border border-gray-100 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-indigo-500 outline-none text-gray-700 dark:text-slate-200 transition-all text-sm"></textarea>
            </section>

            <section class="space-y-3">
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 block tracking-[0.2em] uppercase">Step 03. è¦–è¦ºé¢¨æ ¼ (é›™å±¤è¯å‹•)</label>
                
                <select id="styleCategory" onchange="vibrate(); updateSpecificStyles()" class="w-full p-4 bg-indigo-50/50 dark:bg-slate-900 border border-indigo-100 dark:border-slate-700 rounded-2xl font-black text-indigo-600 dark:text-indigo-400 outline-none text-sm shadow-sm">
                    <option value="" disabled selected>1. å…ˆé¸æ“‡é¢¨æ ¼é¡åˆ¥...</option>
                    <option value="Photography">ğŸ“¸ æ”å½±èˆ‡ç…§ç‰‡</option>
                    <option value="Painting">ğŸ–Œï¸ ç¹ªç•«åª’æèˆ‡è³ªæ„Ÿ</option>
                    <option value="ArtMovements">ğŸ›ï¸ è—è¡“æµæ´¾èˆ‡æµæ´¾</option>
                    <option value="FamousArtists">ğŸ¨ çŸ¥åè—è¡“å®¶å¤§å¸«</option>
                    <option value="AnimeComics">ğŸ¬ å‹•ç•«èˆ‡æ¼«ç•«</option>
                    <option value="DesignSpecial">âœ¨ ç‰¹æ®Šèˆ‡è¨­è¨ˆé¢¨æ ¼</option>
                    <option value="BusinessPro">ğŸ’¼ å°ˆæ¥­å•†å‹™èˆ‡æ‡‰ç”¨</option>
                </select>

                <select id="styleDetail" onchange="vibrate(); updatePreview()" class="w-full p-4 bg-gray-50 dark:bg-slate-900 border border-gray-100 dark:border-slate-700 rounded-2xl font-bold text-gray-700 dark:text-slate-200 outline-none text-sm shadow-sm" disabled>
                    <option value="">2. å†é¸æ“‡å…·é«”é¢¨æ ¼...</option>
                </select>

                <div id="previewCard" class="hidden p-4 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-indigo-100 dark:border-slate-700 animate-in fade-in">
                    <p id="previewText" class="text-xs text-indigo-600 dark:text-indigo-300 leading-relaxed font-bold"></p>
                </div>
            </section>

            <section>
                <label class="text-[10px] font-black text-indigo-500 dark:text-indigo-400 mb-3 block tracking-[0.2em] uppercase">Step 04. é•·å¯¬æ¯”ä¾‹</label>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="setRatio('1:1', this)" class="ratio-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-[10px] font-medium transition-all">1:1</button>
                    <button onclick="setRatio('4:5', this)" class="ratio-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-[10px] font-medium transition-all">4:5</button>
                    <button id="defaultRatioBtn" onclick="setRatio('9:16', this)" class="ratio-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-2.5 rounded-xl text-indigo-700 dark:text-indigo-300 text-[10px] font-bold transition-all shadow-sm">9:16</button>
                    <button onclick="setRatio('16:9', this)" class="ratio-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-[10px] font-medium transition-all">16:9</button>
                    <button onclick="setRatio('3:2', this)" class="ratio-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-[10px] font-medium transition-all">3:2</button>
                    <button onclick="setRatio('21:9', this)" class="ratio-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-[10px] font-medium transition-all">21:9</button>
                </div>
            </section>

            <button onclick="vibrate(); generate()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-black py-4 rounded-2xl shadow-xl active:scale-[0.96] flex justify-center items-center gap-2 text-lg transition-all">
                ç”Ÿæˆæ‡¶äººæŒ‡ä»¤ <i class="fas fa-wand-sparkles"></i>
            </button>

            <div id="resultBox" class="hidden animate-in zoom-in-95 duration-300 pb-4">
                <div class="bg-slate-900 rounded-[2rem] p-7 border border-slate-700 shadow-2xl relative">
                    <p id="finalPrompt" class="text-indigo-200 text-xs font-mono whitespace-pre-line leading-relaxed bg-slate-950 p-5 rounded-2xl border border-white/5 shadow-inner mb-6"></p>
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="vibrate(); copyText()" class="bg-indigo-600 text-white p-4 rounded-xl text-xs font-black"><i class="far fa-copy"></i></button>
                        <button onclick="vibrate(); shareLine()" class="bg-[#06C755] text-white p-4 rounded-xl text-xs font-black"><i class="fab fa-line text-lg"></i></button>
                        <button onclick="vibrate(); shareFB()" class="bg-[#1877F2] text-white p-4 rounded-xl text-xs font-black"><i class="fab fa-facebook text-lg"></i></button>
                    </div>
                </div>
            </div>

            <section id="historySection" class="pt-2 pb-6">
                <div class="flex items-center justify-between mb-4 px-1">
                    <label class="text-[10px] font-black text-gray-400 uppercase tracking-widest">æ­·å²ç´€éŒ„</label>
                    <button onclick="vibrate(); clearHistory()" class="text-[10px] font-bold text-indigo-500">æ¸…é™¤</button>
                </div>
                <div id="historyList" class="space-y-3"></div>
            </section>
        </div>
    </div>

    <script>
        // --- å…·é«”é¢¨æ ¼é¡¯ç¤ºåç¨±å°ç…§è¡¨ (è£œå›ä¸­æ–‡æ¨™ç±¤) ---
        const styleDisplayNames = {
            "Photo": "æ¨™æº–ç…§ç‰‡ Photo", "Cinematic": "é›»å½±è³ªæ„Ÿ Cinematic", "DSLR": "å–®çœ¼ç›¸æ©Ÿ DSLR", "Polaroid": "æ‹ç«‹å¾— Polaroid", "Fujifilm": "å¯Œå£«åº•ç‰‡ Fujifilm", "Vintage Photo": "å¾©å¤è€ç…§ç‰‡ Vintage", "Macro lens": "å¾®è·é¡é ­ Macro", "Wide angle lens": "å»£è§’é¡é ­ Wide", "Fish eye lens": "é­šçœ¼é¡é ­ Fish-eye", "Tilt shift lens": "ç§»è»¸é¡é ­ Tilt-shift", "Golden hour": "é»ƒé‡‘æ™‚åˆ» Golden Hour", "Bokeh": "æ•£æ™¯æ•ˆæœ Bokeh",
            "Oil Painting": "å¤å…¸æ²¹ç•« Oil", "Watercolor": "é€æ˜æ°´å½© Watercolor", "Acrylic Painting": "å£“å…‹åŠ›ç•« Acrylic", "Sketch": "ç´ æè‰åœ– Sketch", "Charcoal Drawing": "ç‚­ç­†ç•« Charcoal", "Ink Drawing": "æ°´å¢¨ç•« Ink", "Ukiyo-e": "æ—¥æœ¬æµ®ä¸–ç¹ª Ukiyo-e", "Gongbi Painting": "ä¸­åœ‹å·¥ç­†ç•« Gongbi", "Printmaking": "ç‰ˆç•«é¢¨æ ¼ Printmaking", "Fresco": "æ¿•å£ç•« Fresco",
            "Renaissance": "æ–‡è—å¾©èˆˆ Renaissance", "Baroque": "å·´æ´›å…‹ Baroque", "Impressionism": "å°è±¡æ´¾ Impressionism", "Cubism": "ç«‹é«”æ´¾ Cubism", "Surrealism": "è¶…ç¾å¯¦ä¸»ç¾© Surrealism", "Pop Art": "æ™®æ™®è—è¡“ Pop Art", "Minimalism": "æ¥µç°¡ä¸»ç¾© Minimalism", "Cyberpunk": "è³½åšé¾å…‹ Cyberpunk", "Steampunk": "è’¸æ°£é¾å…‹ Steampunk",
            "Da Vinci": "é”æ–‡è¥¿ Da Vinci", "Van Gogh": "æ¢µè°· Van Gogh", "Picasso": "ç•¢å¡ç´¢ Picasso", "Dali": "é”åˆ© Dali", "Monet": "è«å…§ Monet", "Andy Warhol": "å®‰è¿ªæ²ƒè· Warhol", "Kusama Yayoi": "è‰é–“å½Œç”Ÿ Kusama",
            "Disney Animation": "è¿ªå£«å°¼é¢¨æ ¼ Disney", "Pixar Animation": "çš®å…‹æ–¯ 3D Pixar", "Studio Ghibli": "å‰åœåŠ›æ‰‹ç¹ª Ghibli", "Anime": "æ—¥æœ¬å‹•æ¼« Anime", "Manga": "æ—¥æœ¬æ¼«ç•« Manga", "American Comic": "ç¾å¼æ¼«ç•« Comic", "Claymation": "é»åœŸå®šæ ¼ Claymation",
            "Logo Design": "æ¨™èªŒè¨­è¨ˆ Logo", "Flat Design": "æ‰å¹³è¨­è¨ˆ Flat", "Infographic": "è³‡è¨Šåœ–è¡¨ Info", "Blueprint": "å·¥ç¨‹è—åœ– Blueprint", "Origami": "æ‘ºç´™è—è¡“ Origami", "Paper Cutout": "å‰ªç´™è—è¡“ Paper Cut", "Pixel Art": "åƒç´ è—è¡“ Pixel Art", "Isometric 3D": "ç­‰è·ç«‹é«” Isometric", "Low Poly": "ä½å¤šé‚Šå½¢ Low Poly", "3D Render": "3D æ¸²æŸ“ Render", "LEGO": "æ¨‚é«˜ç©æœ¨ LEGO",
            "McKinsey": "é¡§å•é¢¨ McKinsey", "Corporate": "ä¼æ¥­è³ªæ„Ÿ Corporate", "Professional": "å°ˆæ¥­ç°¡å ± Professional"
        };

        const categoryMap = {
            "Photography": ["Photo", "Cinematic", "DSLR", "Polaroid", "Fujifilm", "Vintage Photo", "Macro lens", "Wide angle lens", "Fish eye lens", "Tilt shift lens", "Golden hour", "Bokeh"],
            "Painting": ["Oil Painting", "Watercolor", "Acrylic Painting", "Sketch", "Charcoal Drawing", "Ink Drawing", "Ukiyo-e", "Gongbi Painting", "Printmaking", "Fresco"],
            "ArtMovements": ["Renaissance", "Baroque", "Impressionism", "Cubism", "Surrealism", "Pop Art", "Minimalism", "Cyberpunk", "Steampunk"],
            "FamousArtists": ["Da Vinci", "Van Gogh", "Picasso", "Dali", "Monet", "Andy Warhol", "Kusama Yayoi"],
            "AnimeComics": ["Disney Animation", "Pixar Animation", "Studio Ghibli", "Anime", "Manga", "American Comic", "Claymation"],
            "DesignSpecial": ["Logo Design", "Flat Design", "Infographic", "Blueprint", "Origami", "Paper Cutout", "Pixel Art", "Isometric 3D", "Low Poly", "3D Render", "LEGO"],
            "BusinessPro": ["McKinsey", "Corporate", "Professional"]
        };

        const styleSpecs = {
            "Photo": { spec: "Realistic photography, natural lighting.", desc: "å¯«å¯¦é€šç”¨çš„æ”å½±é¢¨æ ¼ã€‚" },
            "Cinematic": { spec: "Cinematic movie still, dramatic lighting, color grading.", desc: "æˆ²åŠ‡åŒ–å…‰å½±èˆ‡è‰²èª¿æ„Ÿã€‚" },
            "DSLR": { spec: "Shot on DSLR, high resolution, sharp focus.", desc: "å°ˆæ¥­ã€æ¸…æ™°çš„å½±åƒè³ªæ„Ÿã€‚" },
            "Polaroid": { spec: "Polaroid instant film, vintage colors, white frame.", desc: "å¾©å¤åº•ç‰‡è‰²åèˆ‡ç™½æ¡†æ„Ÿã€‚" },
            "Fujifilm": { spec: "Fujifilm film grain, vibrant film colors.", desc: "ç¶“å…¸è† æ²é¡†ç²’èˆ‡ç™¼è‰²ã€‚" },
            "Vintage Photo": { spec: "Aged photograph, sepia tones, worn texture.", desc: "æ‡·èˆŠæ­²æœˆç—•è·¡ã€‚" },
            "Macro lens": { spec: "Macro photography, extreme close-up, high detail.", desc: "æ•æ‰æ¥µç´°å¾®ç‰©é«”çš„ç´°ç¯€ã€‚" },
            "Wide angle lens": { spec: "Wide angle view, expansive landscape.", desc: "è¦–é‡é¼é—Šå…·å‚™ç©ºé–“å¼µåŠ›ã€‚" },
            "Fish eye lens": { spec: "Fish eye distortion, ultra-wide circular view.", desc: "èª‡å¼µçš„åœ“å½¢æ‰­æ›²è¦–è§’ã€‚" },
            "Tilt shift lens": { spec: "Tilt shift effect, miniature selective focus.", desc: "è®“ä¸–ç•Œè®Šå°äººåœ‹æ¨¡å‹ã€‚" },
            "Golden hour": { spec: "Golden hour, warm sunlight, soft shadows.", desc: "æ—¥å‡ºæ—¥è½çš„æº«æš–å…‰å½±ã€‚" },
            "Bokeh": { spec: "Strong bokeh, blurred background lights.", desc: "è¿·äººçš„èƒŒå½±æ¨¡ç³Šå…‰æ–‘ã€‚" },
            "Oil Painting": { spec: "Oil painting, rich brushstrokes, canvas.", desc: "æ¿ƒéƒç­†è§¸èˆ‡ç•«å¸ƒè³ªæ„Ÿã€‚" },
            "Watercolor": { spec: "Watercolor, soft wash, paper texture.", desc: "æ¸…é€æšˆæŸ“èˆ‡è—è¡“ç­†è§¸ã€‚" },
            "Acrylic Painting": { spec: "Acrylic, bold colors, textured finish.", desc: "é®®è±”é£½å’Œå…·å‚™å †ç–Šæ„Ÿã€‚" },
            "Sketch": { spec: "Pencil sketch, rough lines, hand-drawn.", desc: "æ‰‹ç¹ªç·šæ¢èˆ‡é™°å½±è³ªæ„Ÿã€‚" },
            "Charcoal Drawing": { spec: "Charcoal drawing, smudged texture, deep blacks.", desc: "ç²—ç·ã€é«˜å°æ¯”é»‘ç™½é¢¨æ ¼ã€‚" },
            "Ink Drawing": { spec: "Traditional ink drawing, sumi-e, negative space.", desc: "å¼·èª¿ç­†å¢¨ç¥éŸ»èˆ‡ç•™ç™½ã€‚" },
            "Ukiyo-e": { spec: "Ukiyo-e woodblock print, bold outlines.", desc: "ç¶“å…¸æœ¨åˆ»ç‰ˆç•«é¢¨æ ¼ã€‚" },
            "Gongbi Painting": { spec: "Gongbi painting, meticulous brushwork.", desc: "ç²¾è¬¹ç´°è†©çš„å‚³çµ±ç•«é¢¨ã€‚" },
            "Printmaking": { spec: "Printmaking style, textured ink transfer.", desc: "æ‰‹å·¥åˆ»å°çš„ç¨ç‰¹è³ªæ„Ÿã€‚" },
            "Fresco": { spec: "Fresco wall painting, aged plaster texture.", desc: "å¤æ¨¸ç°æ³¥ç‰†å£è³ªæ„Ÿã€‚" },
            "Renaissance": { spec: "Renaissance art, sfumato, realistic anatomy.", desc: "å¤å…¸å¯«å¯¦èˆ‡æ§‹åœ–ã€‚" },
            "Baroque": { spec: "Baroque style, chiaroscuro, intense emotion.", desc: "æˆ²åŠ‡æ€§å…‰å½±èˆ‡å‹•æ…‹æ„Ÿã€‚" },
            "Impressionism": { spec: "Impressionism, visible strokes, atmospheric light.", desc: "æ•æ‰å…‰å½±è®ŠåŒ–çš„ç¬é–“ã€‚" },
            "Cubism": { spec: "Cubism, fragmented geometry, multiple views.", desc: "å¹¾ä½•è§£æ§‹èˆ‡å¤šè¦–è§’çµ„ã€‚" },
            "Surrealism": { spec: "Surrealism, dreamlike scenes, melting forms.", desc: "å¦‚å¤¢å¢ƒèˆ¬çš„å¥‡å¹»è’èª•ã€‚" },
            "Pop Art": { spec: "Pop Art, bold colors, halftone dots.", desc: "å¤§è†½é…è‰²èˆ‡ç¬¦è™Ÿå…ƒç´ ã€‚" },
            "Minimalism": { spec: "Minimalism, extreme simplicity, clean lines.", desc: "æ¥µè‡´ç°¡ç´„ï¼Œå°‘å³æ˜¯å¤šã€‚" },
            "Cyberpunk": { spec: "Cyberpunk, neon lights, futuristic cityscape.", desc: "éœ“è™¹èˆ‡æœªä¾†å»¢åœŸæ„Ÿã€‚" },
            "Steampunk": { spec: "Steampunk, brass gears, Victorian machinery.", desc: "ç¶­å¤šåˆ©äºæ©Ÿæ¢°ç¾å­¸ã€‚" },
            "Da Vinci": { spec: "Leonardo da Vinci sketches, sepia ink, aged paper.", desc: "æ‰‹ç¨¿ç­†è¨˜èˆ‡ç²¾å¯†ç´ æã€‚" },
            "Van Gogh": { spec: "Vincent van Gogh style, thick impasto, swirling.", desc: "å¼·çƒˆæƒ…æ„Ÿçš„æ—‹è½‰ç­†è§¸ã€‚" },
            "Picasso": { spec: "Pablo Picasso style, fragmented forms.", desc: "ç«‹é«”æ´¾èˆ‡æŠ½è±¡è§£æ§‹ã€‚" },
            "Dali": { spec: "Salvador DalÃ­ style, melting objects, dream logic.", desc: "è¶…ç¾å¯¦çš„å¤¢å¹»æ‰­æ›²ã€‚" },
            "Monet": { spec: "Claude Monet style, soft light, hazy garden.", desc: "æŸ”å’Œå…‰å½±èˆ‡å°è±¡æ´¾é¢¨æ™¯ã€‚" },
            "Andy Warhol": { spec: "Andy Warhol style, silk screen printing, high contrast.", desc: "çµ²ç¶²å°åˆ·æ™®æ™®é¢¨ã€‚" },
            "Kusama Yayoi": { spec: "Yayoi Kusama style, infinite polka dots.", desc: "æ¨™èªŒæ€§çš„ç„¡é™åœ“é»ã€‚" },
            "Disney Animation": { spec: "Disney animation style, fairytale feel.", desc: "æ‰‹ç¹ªå‹•ç•«çš„ç«¥è©±æ„Ÿã€‚" },
            "Pixar Animation": { spec: "Pixar 3D style, high quality CGI.", desc: "é«˜å“è³ªçš„ 3D å‹•ç•«è³ªæ„Ÿã€‚" },
            "Studio Ghibli": { spec: "Studio Ghibli, hand-painted watercolor look.", desc: "æ¸…æ–°æº«æ½¤çš„æ‰‹ç¹ªæ°´å½©é¢¨ã€‚" },
            "Anime": { spec: "Typical Japanese anime, cel-shading.", desc: "æ¨™æº–æ—¥ç³»å‹•ç•«è¦–è¦ºã€‚" },
            "Manga": { spec: "Black and white manga, screen tones, ink.", desc: "é»‘ç™½ç¶²é»èˆ‡ç­†å¢¨é¢¨æ ¼ã€‚" },
            "American Comic": { spec: "American comic book, bold outlines, action.", desc: "ç²—ç·ç·šæ¢èˆ‡å¼µåŠ›ã€‚" },
            "Claymation": { spec: "Claymation stop-motion, plasticine texture.", desc: "æ‰‹å·¥æè£½çš„å‹•ç•«æ„Ÿã€‚" },
            "Logo Design": { spec: "Minimalist vector logo, isolated on white.", desc: "ç°¡ç´„ã€å°ˆæ¥­çš„å‘é‡åœ–ã€‚" },
            "Flat Design": { spec: "Flat design illustration, simple shapes.", desc: "ç°¡æ½”æ˜äº®çš„ç¾ä»£æ’ç•«ã€‚" },
            "Infographic": { spec: "Infographic, data visualization, icons.", desc: "æ¸…æ™°çš„æ•¸æ“šè¦–è¦ºåŒ–ã€‚" },
            "Blueprint": { spec: "Technical blueprint, white lines on blue grid.", desc: "åš´è¬¹çš„æŠ€è¡“è£½åœ–ç¾å­¸ã€‚" },
            "Origami": { spec: "Origami art, folded paper textures.", desc: "ç´™å¼µæŠ˜ç–Šçš„å¹¾ä½•æ„Ÿã€‚" },
            "Paper Cutout": { spec: "Paper cutout art, layered, drop shadows.", desc: "å±¤ç–Šç´™å¼µçš„ç«‹é«”æ„Ÿã€‚" },
            "Pixel Art": { spec: "Pixel art style, 8-bit retro game aesthetic.", desc: "å¾©å¤é»é™£åœ–éŠæˆ²é¢¨ã€‚" },
            "Isometric 3D": { spec: "Isometric 3D render, geometric shapes.", desc: "é©åˆæ¶æ§‹çš„ 3D è¦–è§’ã€‚" },
            "Low Poly": { spec: "Low poly 3D, faceted geometric mesh.", desc: "å¹¾ä½•åˆ»é¢çš„ 3D é¢¨æ ¼ã€‚" },
            "3D Render": { spec: "High quality 3D render, octane, studio light.", desc: "é«˜å“è³ªçš„æ•¸ä½ä¸‰ç¶­å½±åƒã€‚" },
            "LEGO": { spec: "LEGO bricks, plastic studs, toy construction.", desc: "ç©æœ¨æ‹¼ç Œæˆçš„ä¸–ç•Œã€‚" },
            "McKinsey": { spec: "McKinsey consulting style, structured data.", desc: "å°ˆæ¥­é‚è¼¯èˆ‡å•†å‹™ç°¡å ±æ„Ÿã€‚" },
            "Corporate": { spec: "Corporate branding, sleek professional photo.", desc: "ç¾ä»£å“ç‰Œçš„å°ˆæ¥­æ„Ÿã€‚" },
            "Professional": { spec: "Clean professional design, balanced layout.", desc: "é©åˆæ­£å¼å ´åˆçš„è¨­è¨ˆã€‚" }
        };

        // --- æ ¸å¿ƒé‚è¼¯ ---
        let selectedType = 'general';
        let selectedRatio = '9:16';
        let history = JSON.parse(localStorage.getItem('prompt_history_v68') || '[]');

        function vibrate() { if (navigator.vibrate) navigator.vibrate(15); }

        function updateSpecificStyles(defaultStyle = "") {
            const category = document.getElementById('styleCategory').value;
            const styleDetail = document.getElementById('styleDetail');
            
            styleDetail.innerHTML = '<option value="">2. å†é¸æ“‡å…·é«”é¢¨æ ¼...</option>';
            styleDetail.disabled = !category;

            if (category && categoryMap[category]) {
                categoryMap[category].forEach(key => {
                    const opt = document.createElement('option');
                    opt.value = key;
                    // ä½¿ç”¨é¡¯ç¤ºåç¨±å°ç…§è¡¨ (è£œå›ä¸­æ–‡)
                    opt.textContent = styleDisplayNames[key] || key;
                    styleDetail.appendChild(opt);
                });
                if (defaultStyle) styleDetail.value = defaultStyle;
            }
            updatePreview();
        }

        function setType(type, btn) {
            selectedType = type;
            document.querySelectorAll('.type-btn').forEach(b => {
                b.className = 'type-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all';
            });
            btn.className = 'type-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-2.5 rounded-xl text-indigo-700 dark:text-indigo-300 text-[10px] font-bold transition-all shadow-sm';
        }

        function setRatio(ratio, btn) {
            vibrate(); selectedRatio = ratio;
            document.querySelectorAll('.ratio-btn').forEach(b => {
                b.className = 'ratio-btn border border-gray-100 dark:border-slate-700 p-2.5 rounded-xl text-gray-500 dark:text-slate-400 text-[10px] font-medium transition-all';
            });
            btn.className = 'ratio-btn ring-2 ring-indigo-500 bg-indigo-50 dark:bg-indigo-900/40 p-2.5 rounded-xl text-indigo-700 dark:text-indigo-300 text-[10px] font-bold transition-all shadow-sm';
        }

        function randomStyleOnly() {
            vibrate();
            const icon = document.getElementById('diceIcon');
            icon.classList.add('rolling');
            setTimeout(() => icon.classList.remove('rolling'), 500);

            const categories = Object.keys(categoryMap);
            const randomCat = categories[Math.floor(Math.random() * categories.length)];
            const stylesInCat = categoryMap[randomCat];
            const randomStyle = stylesInCat[Math.floor(Math.random() * stylesInCat.length)];

            document.getElementById('styleCategory').value = randomCat;
            updateSpecificStyles(randomStyle);
        }

        function updatePreview() {
            const style = document.getElementById('styleDetail').value;
            const card = document.getElementById('previewCard');
            if(style && styleSpecs[style]) {
                document.getElementById('previewText').innerText = "ğŸ’¡ èªªæ˜ï¼š" + styleSpecs[style].desc;
                card.classList.remove('hidden');
            } else { card.classList.add('hidden'); }
        }

        function generate() {
            const content = document.getElementById('content').value.trim() || "Mysterious AI Creation";
            const style = document.getElementById('styleDetail').value;
            if(!style) return alert('è«‹å…ˆé¸å–è¦–è¦ºé¢¨æ ¼ï¼');
            
            const typeLabel = (selectedType === 'general') ? "image" : selectedType;
            const prompt = `/imagine prompt: A ${style} style ${typeLabel} about '${content}'. \n- ${styleSpecs[style].spec} \n- Aspect ratio: ${selectedRatio} --ar ${selectedRatio} --v 6.0`;
            
            document.getElementById('finalPrompt').innerText = prompt;
            document.getElementById('resultBox').classList.remove('hidden');
            saveToHistory(style, content, prompt);
        }

        function saveToHistory(s, c, p) {
            history.unshift({ style: s, content: c, prompt: p });
            if (history.length > 5) history.pop();
            localStorage.setItem('prompt_history_v68', JSON.stringify(history));
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = history.map((item, index) => `
                <div class="p-4 bg-gray-50 dark:bg-slate-900 rounded-2xl border flex justify-between items-center active:scale-95 transition-all shadow-sm" onclick="loadFromHistory(${index})">
                    <div class="overflow-hidden">
                        <p class="text-[9px] font-black text-indigo-500 uppercase">${styleDisplayNames[item.style] || item.style}</p>
                        <p class="text-[12px] text-gray-700 dark:text-slate-300 font-bold truncate w-48">${item.content}</p>
                    </div>
                    <i class="fas fa-magic text-[10px] text-indigo-300"></i>
                </div>`).join('');
        }

        function loadFromHistory(i) {
            vibrate();
            document.getElementById('finalPrompt').innerText = history[i].prompt;
            document.getElementById('resultBox').classList.remove('hidden');
        }

        function clearHistory() { history = []; localStorage.removeItem('prompt_history_v68'); renderHistory(); }
        function copyText() { navigator.clipboard.writeText(document.getElementById('finalPrompt').innerText); alert('æŒ‡ä»¤å·²è¤‡è£½ï¼'); }
        function shareLine() { window.open(`https://line.me/R/msg/text/?${encodeURIComponent(document.getElementById('finalPrompt').innerText)}`); }
        function shareFB() { window.open(`https://www.facebook.com/sharer/sharer.php?u=${window.location.href}`); }

        renderHistory();
    </script>
</body>
</html>
